2025-10-31 09:49:41,288 - __main__ - [INFO] - main.py:102 - Logging system initialized
2025-10-31 09:49:41,378 - __main__ - [INFO] - main.py:260 - Initialized IMAP connection pool with max_connections=5
2025-10-31 09:49:42,363 - __main__ - [INFO] - main.py:1979 - Starting Outlook Email Management System on 0.0.0.0:8000
2025-10-31 09:49:42,364 - __main__ - [INFO] - main.py:1980 - Access the web interface at: http://localhost:8000
2025-10-31 09:49:42,365 - __main__ - [INFO] - main.py:1981 - Access the API documentation at: http://localhost:8000/docs
2025-10-31 09:49:42,956 - __main__ - [INFO] - main.py:1290 - Starting Outlook Email Management System v2.0...
2025-10-31 09:49:42,958 - __main__ - [INFO] - main.py:1293 - Initializing database...
2025-10-31 09:49:42,971 - __main__ - [INFO] - main.py:1295 - Database initialized successfully
2025-10-31 09:49:43,010 - __main__ - [INFO] - main.py:1302 - API Key initialized
2025-10-31 09:49:43,011 - __main__ - [INFO] - main.py:1306 - IMAP connection pool initialized with max_connections=5
2025-10-31 09:49:43,012 - __main__ - [INFO] - main.py:1312 - Token refresh background task scheduled
2025-10-31 09:49:43,013 - __main__ - [INFO] - main.py:1204 - Token refresh background task started
2025-10-31 09:49:43,014 - __main__ - [INFO] - main.py:1208 - Starting scheduled token refresh for all accounts...
2025-10-31 09:49:55,148 - __main__ - [INFO] - main.py:896 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 09:49:55,197 - __main__ - [INFO] - main.py:1253 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 09:50:06,945 - __main__ - [INFO] - main.py:896 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 09:50:06,987 - __main__ - [INFO] - main.py:1253 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 09:50:06,988 - __main__ - [INFO] - main.py:1272 - Token refresh completed: 2 succeeded, 0 failed
2025-10-31 09:50:42,853 - __main__ - [INFO] - main.py:1497 - [API] GET /accounts 收到请求:
2025-10-31 09:50:42,855 - __main__ - [INFO] - main.py:1498 -   page=1, page_size=10
2025-10-31 09:50:42,856 - __main__ - [INFO] - main.py:1499 -   email_search=None, tag_search=None
2025-10-31 09:50:42,857 - __main__ - [INFO] - main.py:1500 -   refresh_status=None, time_filter=None
2025-10-31 09:50:42,859 - __main__ - [INFO] - main.py:1501 -   after_date=None
2025-10-31 09:50:42,861 - __main__ - [INFO] - main.py:1502 -   refresh_start_date=None
2025-10-31 09:50:42,863 - __main__ - [INFO] - main.py:1503 -   refresh_end_date=None
2025-10-31 09:50:42,876 - __main__ - [INFO] - main.py:1518 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 09:50:43,083 - __main__ - [INFO] - main.py:1497 - [API] GET /accounts 收到请求:
2025-10-31 09:50:43,085 - __main__ - [INFO] - main.py:1498 -   page=1, page_size=10
2025-10-31 09:50:43,086 - __main__ - [INFO] - main.py:1499 -   email_search=None, tag_search=None
2025-10-31 09:50:43,087 - __main__ - [INFO] - main.py:1500 -   refresh_status=None, time_filter=None
2025-10-31 09:50:43,088 - __main__ - [INFO] - main.py:1501 -   after_date=None
2025-10-31 09:50:43,089 - __main__ - [INFO] - main.py:1502 -   refresh_start_date=None
2025-10-31 09:50:43,090 - __main__ - [INFO] - main.py:1503 -   refresh_end_date=None
2025-10-31 09:50:43,103 - __main__ - [INFO] - main.py:1518 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 09:50:43,226 - __main__ - [INFO] - main.py:1497 - [API] GET /accounts 收到请求:
2025-10-31 09:50:43,227 - __main__ - [INFO] - main.py:1498 -   page=1, page_size=10
2025-10-31 09:50:43,228 - __main__ - [INFO] - main.py:1499 -   email_search=None, tag_search=None
2025-10-31 09:50:43,229 - __main__ - [INFO] - main.py:1500 -   refresh_status=None, time_filter=None
2025-10-31 09:50:43,230 - __main__ - [INFO] - main.py:1501 -   after_date=None
2025-10-31 09:50:43,232 - __main__ - [INFO] - main.py:1502 -   refresh_start_date=None
2025-10-31 09:50:43,236 - __main__ - [INFO] - main.py:1503 -   refresh_end_date=None
2025-10-31 09:50:43,247 - __main__ - [INFO] - main.py:1518 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 10:15:37,901 - __main__ - [INFO] - main.py:1376 - Admin admin logged in successfully
2025-10-31 10:15:42,176 - __main__ - [INFO] - main.py:1497 - [API] GET /accounts 收到请求:
2025-10-31 10:15:42,176 - __main__ - [INFO] - main.py:1498 -   page=1, page_size=10
2025-10-31 10:15:42,177 - __main__ - [INFO] - main.py:1499 -   email_search=None, tag_search=None
2025-10-31 10:15:42,178 - __main__ - [INFO] - main.py:1500 -   refresh_status=None, time_filter=None
2025-10-31 10:15:42,178 - __main__ - [INFO] - main.py:1501 -   after_date=None
2025-10-31 10:15:42,179 - __main__ - [INFO] - main.py:1502 -   refresh_start_date=None
2025-10-31 10:15:42,180 - __main__ - [INFO] - main.py:1503 -   refresh_end_date=None
2025-10-31 10:15:42,189 - __main__ - [INFO] - main.py:1518 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 10:19:37,859 - __main__ - [INFO] - main.py:1497 - [API] GET /accounts 收到请求:
2025-10-31 10:19:37,860 - __main__ - [INFO] - main.py:1498 -   page=1, page_size=1
2025-10-31 10:19:37,861 - __main__ - [INFO] - main.py:1499 -   email_search=None, tag_search=None
2025-10-31 10:19:37,861 - __main__ - [INFO] - main.py:1500 -   refresh_status=None, time_filter=None
2025-10-31 10:19:37,862 - __main__ - [INFO] - main.py:1501 -   after_date=None
2025-10-31 10:19:37,862 - __main__ - [INFO] - main.py:1502 -   refresh_start_date=None
2025-10-31 10:19:37,862 - __main__ - [INFO] - main.py:1503 -   refresh_end_date=None
2025-10-31 10:19:37,870 - __main__ - [INFO] - main.py:1518 - [API] 查询结果: 总数=2, 返回=1条
2025-10-31 10:20:04,261 - __main__ - [INFO] - main.py:1497 - [API] GET /accounts 收到请求:
2025-10-31 10:20:04,262 - __main__ - [INFO] - main.py:1498 -   page=1, page_size=10
2025-10-31 10:20:04,262 - __main__ - [INFO] - main.py:1499 -   email_search=None, tag_search=None
2025-10-31 10:20:04,263 - __main__ - [INFO] - main.py:1500 -   refresh_status=None, time_filter=None
2025-10-31 10:20:04,263 - __main__ - [INFO] - main.py:1501 -   after_date=None
2025-10-31 10:20:04,264 - __main__ - [INFO] - main.py:1502 -   refresh_start_date=None
2025-10-31 10:20:04,264 - __main__ - [INFO] - main.py:1503 -   refresh_end_date=None
2025-10-31 10:20:04,272 - __main__ - [INFO] - main.py:1518 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 10:20:15,423 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 10:20:18,099 - __main__ - [INFO] - main.py:294 - Successfully created IMAP connection for hprjiocj465@outlook.com
2025-10-31 10:21:20,897 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 10:23:42,646 - __main__ - [INFO] - main.py:1497 - [API] GET /accounts 收到请求:
2025-10-31 10:23:42,647 - __main__ - [INFO] - main.py:1498 -   page=1, page_size=10
2025-10-31 10:23:42,648 - __main__ - [INFO] - main.py:1499 -   email_search=None, tag_search=None
2025-10-31 10:23:42,649 - __main__ - [INFO] - main.py:1500 -   refresh_status=None, time_filter=None
2025-10-31 10:23:42,649 - __main__ - [INFO] - main.py:1501 -   after_date=None
2025-10-31 10:23:42,650 - __main__ - [INFO] - main.py:1502 -   refresh_start_date=None
2025-10-31 10:23:42,651 - __main__ - [INFO] - main.py:1503 -   refresh_end_date=None
2025-10-31 10:23:42,659 - __main__ - [INFO] - main.py:1518 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 10:25:53,517 - __main__ - [INFO] - main.py:1497 - [API] GET /accounts 收到请求:
2025-10-31 10:25:53,518 - __main__ - [INFO] - main.py:1498 -   page=1, page_size=10
2025-10-31 10:25:53,518 - __main__ - [INFO] - main.py:1499 -   email_search=None, tag_search=None
2025-10-31 10:25:53,519 - __main__ - [INFO] - main.py:1500 -   refresh_status=None, time_filter=None
2025-10-31 10:25:53,519 - __main__ - [INFO] - main.py:1501 -   after_date=None
2025-10-31 10:25:53,520 - __main__ - [INFO] - main.py:1502 -   refresh_start_date=None
2025-10-31 10:25:53,521 - __main__ - [INFO] - main.py:1503 -   refresh_end_date=None
2025-10-31 10:25:53,528 - __main__ - [INFO] - main.py:1518 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 10:26:20,302 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 10:53:38,458 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 11:00:37,899 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 11:09:35,845 - __main__ - [INFO] - main.py:102 - Logging system initialized
2025-10-31 11:09:35,943 - __main__ - [INFO] - main.py:260 - Initialized IMAP connection pool with max_connections=5
2025-10-31 11:09:37,066 - __main__ - [INFO] - main.py:2046 - Starting Outlook Email Management System on 0.0.0.0:8000
2025-10-31 11:09:37,075 - __main__ - [INFO] - main.py:2047 - Access the web interface at: http://localhost:8000
2025-10-31 11:09:37,079 - __main__ - [INFO] - main.py:2048 - Access the API documentation at: http://localhost:8000/docs
2025-10-31 11:09:37,722 - __main__ - [INFO] - main.py:1347 - Starting Outlook Email Management System v2.0...
2025-10-31 11:09:37,731 - __main__ - [INFO] - main.py:1350 - Initializing database...
2025-10-31 11:09:37,893 - __main__ - [INFO] - main.py:1352 - Database initialized successfully
2025-10-31 11:09:37,937 - __main__ - [INFO] - main.py:1359 - API Key initialized
2025-10-31 11:09:37,963 - __main__ - [INFO] - main.py:1363 - IMAP connection pool initialized with max_connections=5
2025-10-31 11:09:37,970 - __main__ - [INFO] - main.py:1369 - Token refresh background task scheduled
2025-10-31 11:09:37,974 - __main__ - [INFO] - main.py:1261 - Token refresh background task started
2025-10-31 11:09:37,976 - __main__ - [INFO] - main.py:1265 - Starting scheduled token refresh for all accounts...
2025-10-31 11:09:49,965 - __main__ - [INFO] - main.py:896 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 11:09:50,007 - __main__ - [INFO] - main.py:1310 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 11:10:01,601 - __main__ - [INFO] - main.py:896 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 11:10:01,644 - __main__ - [INFO] - main.py:1310 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 11:10:01,645 - __main__ - [INFO] - main.py:1329 - Token refresh completed: 2 succeeded, 0 failed
2025-10-31 11:11:19,202 - __main__ - [INFO] - main.py:1433 - Admin admin logged in successfully
2025-10-31 11:11:22,686 - __main__ - [INFO] - main.py:1554 - [API] GET /accounts 收到请求:
2025-10-31 11:11:22,692 - __main__ - [INFO] - main.py:1555 -   page=1, page_size=10
2025-10-31 11:11:22,695 - __main__ - [INFO] - main.py:1556 -   email_search=None, tag_search=None
2025-10-31 11:11:22,717 - __main__ - [INFO] - main.py:1557 -   refresh_status=None, time_filter=None
2025-10-31 11:11:22,724 - __main__ - [INFO] - main.py:1558 -   after_date=None
2025-10-31 11:11:22,742 - __main__ - [INFO] - main.py:1559 -   refresh_start_date=None
2025-10-31 11:11:22,757 - __main__ - [INFO] - main.py:1560 -   refresh_end_date=None
2025-10-31 11:11:22,795 - __main__ - [INFO] - main.py:1575 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 11:14:00,583 - __main__ - [INFO] - main.py:1554 - [API] GET /accounts 收到请求:
2025-10-31 11:14:00,584 - __main__ - [INFO] - main.py:1555 -   page=1, page_size=10
2025-10-31 11:14:00,584 - __main__ - [INFO] - main.py:1556 -   email_search=None, tag_search=None
2025-10-31 11:14:00,585 - __main__ - [INFO] - main.py:1557 -   refresh_status=None, time_filter=None
2025-10-31 11:14:00,586 - __main__ - [INFO] - main.py:1558 -   after_date=None
2025-10-31 11:14:00,586 - __main__ - [INFO] - main.py:1559 -   refresh_start_date=None
2025-10-31 11:14:00,587 - __main__ - [INFO] - main.py:1560 -   refresh_end_date=None
2025-10-31 11:14:00,599 - __main__ - [INFO] - main.py:1575 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 11:14:13,350 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 11:14:15,924 - __main__ - [INFO] - main.py:294 - Successfully created IMAP connection for hprjiocj465@outlook.com
2025-10-31 11:14:17,971 - __main__ - [INFO] - main.py:1111 - Cached 2 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 11:14:32,372 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 11:14:39,111 - __main__ - [INFO] - main.py:1229 - Cached email detail to SQLite for INBOX-1
2025-10-31 11:14:42,728 - __main__ - [INFO] - main.py:1162 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 11:14:46,065 - __main__ - [INFO] - main.py:1162 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 11:14:58,833 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 11:15:00,038 - __main__ - [INFO] - main.py:1229 - Cached email detail to SQLite for INBOX-2
2025-10-31 11:15:45,582 - __main__ - [INFO] - main.py:1162 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 11:18:59,502 - __main__ - [INFO] - main.py:1554 - [API] GET /accounts 收到请求:
2025-10-31 11:18:59,510 - __main__ - [INFO] - main.py:1555 -   page=1, page_size=10
2025-10-31 11:18:59,512 - __main__ - [INFO] - main.py:1556 -   email_search=None, tag_search=None
2025-10-31 11:18:59,515 - __main__ - [INFO] - main.py:1557 -   refresh_status=None, time_filter=None
2025-10-31 11:18:59,516 - __main__ - [INFO] - main.py:1558 -   after_date=None
2025-10-31 11:18:59,517 - __main__ - [INFO] - main.py:1559 -   refresh_start_date=None
2025-10-31 11:18:59,519 - __main__ - [INFO] - main.py:1560 -   refresh_end_date=None
2025-10-31 11:18:59,533 - __main__ - [INFO] - main.py:1575 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 11:19:01,014 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:19:02,576 - __main__ - [INFO] - main.py:1162 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 11:22:04,861 - __main__ - [INFO] - main.py:1554 - [API] GET /accounts 收到请求:
2025-10-31 11:22:04,863 - __main__ - [INFO] - main.py:1555 -   page=1, page_size=10
2025-10-31 11:22:04,864 - __main__ - [INFO] - main.py:1556 -   email_search=None, tag_search=None
2025-10-31 11:22:04,864 - __main__ - [INFO] - main.py:1557 -   refresh_status=None, time_filter=None
2025-10-31 11:22:04,865 - __main__ - [INFO] - main.py:1558 -   after_date=None
2025-10-31 11:22:04,866 - __main__ - [INFO] - main.py:1559 -   refresh_start_date=None
2025-10-31 11:22:04,866 - __main__ - [INFO] - main.py:1560 -   refresh_end_date=None
2025-10-31 11:22:04,879 - __main__ - [INFO] - main.py:1575 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 11:22:07,707 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:22:10,982 - __main__ - [INFO] - main.py:1162 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 11:22:23,424 - __main__ - [INFO] - main.py:950 - Returning 1 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:22:24,871 - __main__ - [INFO] - main.py:950 - Returning 1 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:22:26,762 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:22:28,776 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:22:30,648 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:22:33,351 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:22:37,060 - __main__ - [INFO] - main.py:950 - Returning 1 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:22:40,222 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:22:53,402 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:22:53,437 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:23:17,789 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:23:17,849 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:23:18,408 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 11:23:18,515 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 11:23:18,835 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 11:23:20,576 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:23:20,839 - __main__ - [INFO] - main.py:1111 - Cached 2 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 11:23:21,228 - __main__ - [INFO] - main.py:294 - Successfully created IMAP connection for hprjiocj465@outlook.com
2025-10-31 11:23:21,876 - __main__ - [INFO] - main.py:950 - Returning 1 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:23:23,340 - __main__ - [INFO] - main.py:1111 - Cached 2 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 11:23:23,579 - __main__ - [INFO] - main.py:1111 - Cached 2 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 11:23:35,478 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:23:36,268 - __main__ - [INFO] - main.py:825 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 11:23:38,600 - __main__ - [INFO] - main.py:1111 - Cached 2 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 11:23:39,769 - __main__ - [INFO] - main.py:1162 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 11:23:51,806 - __main__ - [INFO] - main.py:1554 - [API] GET /accounts 收到请求:
2025-10-31 11:23:51,807 - __main__ - [INFO] - main.py:1555 -   page=1, page_size=10
2025-10-31 11:23:51,808 - __main__ - [INFO] - main.py:1556 -   email_search=None, tag_search=None
2025-10-31 11:23:51,809 - __main__ - [INFO] - main.py:1557 -   refresh_status=None, time_filter=None
2025-10-31 11:23:51,810 - __main__ - [INFO] - main.py:1558 -   after_date=None
2025-10-31 11:23:51,811 - __main__ - [INFO] - main.py:1559 -   refresh_start_date=None
2025-10-31 11:23:51,811 - __main__ - [INFO] - main.py:1560 -   refresh_end_date=None
2025-10-31 11:23:51,822 - __main__ - [INFO] - main.py:1575 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 11:26:36,358 - __main__ - [INFO] - main.py:1554 - [API] GET /accounts 收到请求:
2025-10-31 11:26:36,359 - __main__ - [INFO] - main.py:1555 -   page=1, page_size=10
2025-10-31 11:26:36,360 - __main__ - [INFO] - main.py:1556 -   email_search=None, tag_search=None
2025-10-31 11:26:36,360 - __main__ - [INFO] - main.py:1557 -   refresh_status=None, time_filter=None
2025-10-31 11:26:36,362 - __main__ - [INFO] - main.py:1558 -   after_date=None
2025-10-31 11:26:36,363 - __main__ - [INFO] - main.py:1559 -   refresh_start_date=None
2025-10-31 11:26:36,365 - __main__ - [INFO] - main.py:1560 -   refresh_end_date=None
2025-10-31 11:26:36,377 - __main__ - [INFO] - main.py:1575 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 11:26:45,545 - __main__ - [INFO] - main.py:950 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 11:31:28,078 - __main__ - [INFO] - main.py:1162 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 11:31:33,877 - __main__ - [INFO] - main.py:1162 - Returning cached email detail from SQLite for INBOX-2
2025-10-31 11:34:37,956 - __main__ - [INFO] - main.py:1374 - Shutting down Outlook Email Management System...
2025-10-31 11:34:37,957 - __main__ - [INFO] - main.py:1381 - Token refresh background task cancelled
2025-10-31 11:34:37,957 - __main__ - [INFO] - main.py:1383 - Closing IMAP connection pool...
2025-10-31 13:20:47,441 - root - [INFO] - logger_config.py:49 - Logging system initialized
2025-10-31 13:20:48,109 - root - [INFO] - main.py:242 - Starting Outlook邮件API服务 on 0.0.0.0:8000
2025-10-31 13:20:48,119 - root - [INFO] - main.py:243 - Access the web interface at: http://localhost:8000
2025-10-31 13:20:48,122 - root - [INFO] - main.py:244 - Access the API documentation at: http://localhost:8000/docs
2025-10-31 13:20:48,600 - root - [INFO] - main.py:138 - Starting Outlook邮件API服务 v2.0.0...
2025-10-31 13:20:48,602 - root - [INFO] - main.py:141 - Initializing database...
2025-10-31 13:20:48,616 - database - [INFO] - database.py:132 - Database initialized successfully
2025-10-31 13:20:48,617 - root - [INFO] - main.py:143 - Database initialized successfully
2025-10-31 13:20:48,624 - database - [INFO] - database.py:759 - API Key already exists
2025-10-31 13:20:48,624 - root - [INFO] - main.py:150 - API Key initialized
2025-10-31 13:20:48,625 - root - [INFO] - main.py:156 - Token refresh background task scheduled
2025-10-31 13:20:48,626 - root - [INFO] - main.py:46 - Token refresh background task started
2025-10-31 13:20:48,627 - root - [INFO] - main.py:50 - Starting scheduled token refresh for all accounts...
2025-10-31 13:21:00,313 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:21:00,317 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 13:21:00,346 - database - [INFO] - database.py:405 - Updated account: hprjiocj465@outlook.com
2025-10-31 13:21:00,352 - root - [INFO] - main.py:96 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 13:21:19,828 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:21:19,830 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 13:21:19,867 - database - [INFO] - database.py:405 - Updated account: hnybirs6215@outlook.com
2025-10-31 13:21:19,878 - root - [INFO] - main.py:96 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 13:21:19,880 - root - [INFO] - main.py:115 - Token refresh completed: 2 succeeded, 0 failed
2025-10-31 13:33:13,963 - root - [INFO] - main.py:161 - Shutting down Outlook邮件API服务...
2025-10-31 13:33:13,965 - root - [INFO] - main.py:168 - Token refresh background task cancelled
2025-10-31 13:33:13,965 - root - [INFO] - main.py:170 - Closing IMAP connection pool...
2025-10-31 13:33:13,966 - imap_pool - [INFO] - imap_pool.py:194 - Closed total 0 connections for all accounts
2025-10-31 13:33:13,967 - root - [INFO] - main.py:172 - Application shutdown complete.
2025-10-31 13:33:24,772 - root - [INFO] - logger_config.py:49 - Logging system initialized
2025-10-31 13:33:25,259 - root - [INFO] - main.py:242 - Starting Outlook邮件API服务 on 0.0.0.0:8000
2025-10-31 13:33:25,259 - root - [INFO] - main.py:243 - Access the web interface at: http://localhost:8000
2025-10-31 13:33:25,261 - root - [INFO] - main.py:244 - Access the API documentation at: http://localhost:8000/docs
2025-10-31 13:33:25,550 - root - [INFO] - main.py:138 - Starting Outlook邮件API服务 v2.0.0...
2025-10-31 13:33:25,552 - root - [INFO] - main.py:141 - Initializing database...
2025-10-31 13:33:25,564 - database - [INFO] - database.py:132 - Database initialized successfully
2025-10-31 13:33:25,571 - root - [INFO] - main.py:143 - Database initialized successfully
2025-10-31 13:33:25,593 - database - [INFO] - database.py:759 - API Key already exists
2025-10-31 13:33:25,595 - root - [INFO] - main.py:150 - API Key initialized
2025-10-31 13:33:25,598 - root - [INFO] - main.py:156 - Token refresh background task scheduled
2025-10-31 13:33:25,599 - root - [INFO] - main.py:46 - Token refresh background task started
2025-10-31 13:33:25,601 - root - [INFO] - main.py:50 - Starting scheduled token refresh for all accounts...
2025-10-31 13:33:42,918 - passlib.handlers.bcrypt - [WARNING] - bcrypt.py:622 - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "D:\programming\practice\python\OutlookManager2\venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-10-31 13:33:43,596 - routes.auth_routes - [INFO] - auth_routes.py:39 - Admin admin logged in successfully
2025-10-31 13:33:43,973 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:33:43,979 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 13:33:44,087 - database - [INFO] - database.py:405 - Updated account: hprjiocj465@outlook.com
2025-10-31 13:33:44,095 - root - [INFO] - main.py:96 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 13:33:59,661 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:33:59,806 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 13:34:00,005 - database - [INFO] - database.py:405 - Updated account: hnybirs6215@outlook.com
2025-10-31 13:34:00,056 - root - [INFO] - main.py:96 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 13:34:00,058 - root - [INFO] - main.py:115 - Token refresh completed: 2 succeeded, 0 failed
2025-10-31 13:34:04,684 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 13:34:04,686 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 13:34:04,687 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 13:34:04,689 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 13:34:04,690 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 13:34:04,691 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 13:34:04,692 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 13:34:04,701 - database - [INFO] - database.py:310 - [筛选] SQL WHERE子句: 1=1
2025-10-31 13:34:04,703 - database - [INFO] - database.py:311 - [筛选] SQL参数: []
2025-10-31 13:34:04,708 - database - [INFO] - database.py:317 - [筛选] 符合条件的总数: 2
2025-10-31 13:34:04,719 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 13:34:11,421 - email_service - [INFO] - email_service.py:57 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 13:34:13,732 - email_service - [INFO] - email_service.py:264 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 13:34:18,457 - email_service - [INFO] - email_service.py:264 - Returning cached email detail from SQLite for INBOX-2
2025-10-31 13:34:20,268 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 13:34:20,283 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 13:34:20,286 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 13:34:20,288 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 13:34:20,292 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 13:34:20,294 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 13:34:20,296 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 13:34:20,302 - database - [INFO] - database.py:310 - [筛选] SQL WHERE子句: 1=1
2025-10-31 13:34:20,305 - database - [INFO] - database.py:311 - [筛选] SQL参数: []
2025-10-31 13:34:20,310 - database - [INFO] - database.py:317 - [筛选] 符合条件的总数: 2
2025-10-31 13:34:20,320 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 13:34:33,690 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:34:33,692 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hnybirs6215@outlook.com
2025-10-31 13:34:36,056 - imap_pool - [INFO] - imap_pool.py:73 - Successfully created IMAP connection for hnybirs6215@outlook.com
2025-10-31 13:34:38,761 - database - [INFO] - database.py:965 - Cached 2 emails for account hnybirs6215@outlook.com
2025-10-31 13:34:38,769 - email_service - [INFO] - email_service.py:218 - Cached 2 emails to SQLite for hnybirs6215@outlook.com
2025-10-31 13:34:55,102 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:34:55,145 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hnybirs6215@outlook.com
2025-10-31 13:35:07,860 - database - [INFO] - database.py:1096 - Cached email detail for hnybirs6215@outlook.com: INBOX-1
2025-10-31 13:35:07,865 - email_service - [INFO] - email_service.py:331 - Cached email detail to SQLite for INBOX-1
2025-10-31 13:43:05,349 - root - [INFO] - logger_config.py:49 - Logging system initialized
2025-10-31 13:43:06,050 - root - [INFO] - main.py:242 - Starting Outlook邮件API服务 on 0.0.0.0:8000
2025-10-31 13:43:06,051 - root - [INFO] - main.py:243 - Access the web interface at: http://localhost:8000
2025-10-31 13:43:06,052 - root - [INFO] - main.py:244 - Access the API documentation at: http://localhost:8000/docs
2025-10-31 13:43:06,392 - root - [INFO] - main.py:138 - Starting Outlook邮件API服务 v2.0.0...
2025-10-31 13:43:06,406 - root - [INFO] - main.py:141 - Initializing database...
2025-10-31 13:43:06,422 - database - [INFO] - database.py:132 - Database initialized successfully
2025-10-31 13:43:06,430 - root - [INFO] - main.py:143 - Database initialized successfully
2025-10-31 13:43:06,476 - database - [INFO] - database.py:759 - API Key already exists
2025-10-31 13:43:06,480 - root - [INFO] - main.py:150 - API Key initialized
2025-10-31 13:43:06,484 - root - [INFO] - main.py:156 - Token refresh background task scheduled
2025-10-31 13:43:06,485 - root - [INFO] - main.py:46 - Token refresh background task started
2025-10-31 13:43:06,486 - root - [INFO] - main.py:50 - Starting scheduled token refresh for all accounts...
2025-10-31 13:43:20,366 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:43:20,372 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 13:43:20,412 - database - [INFO] - database.py:405 - Updated account: hprjiocj465@outlook.com
2025-10-31 13:43:20,422 - root - [INFO] - main.py:96 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 13:43:33,813 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:43:33,815 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 13:43:33,852 - database - [INFO] - database.py:405 - Updated account: hnybirs6215@outlook.com
2025-10-31 13:43:33,858 - root - [INFO] - main.py:96 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 13:43:33,859 - root - [INFO] - main.py:115 - Token refresh completed: 2 succeeded, 0 failed
2025-10-31 13:44:10,186 - passlib.handlers.bcrypt - [WARNING] - bcrypt.py:622 - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "D:\programming\practice\python\OutlookManager2\venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-10-31 13:44:10,829 - routes.auth_routes - [INFO] - auth_routes.py:39 - Admin admin logged in successfully
2025-10-31 13:44:16,308 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 13:44:16,322 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 13:44:16,459 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 13:44:16,559 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 13:44:16,638 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 13:44:16,648 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 13:44:16,651 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 13:44:16,680 - database - [INFO] - database.py:310 - [筛选] SQL WHERE子句: 1=1
2025-10-31 13:44:16,687 - database - [INFO] - database.py:311 - [筛选] SQL参数: []
2025-10-31 13:44:16,695 - database - [INFO] - database.py:317 - [筛选] 符合条件的总数: 2
2025-10-31 13:44:16,713 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 13:44:20,034 - email_service - [INFO] - email_service.py:57 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 13:44:37,121 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:44:37,123 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 13:44:41,665 - imap_pool - [INFO] - imap_pool.py:73 - Successfully created IMAP connection for hprjiocj465@outlook.com
2025-10-31 13:44:43,918 - database - [INFO] - database.py:965 - Cached 2 emails for account hprjiocj465@outlook.com
2025-10-31 13:44:43,924 - email_service - [INFO] - email_service.py:218 - Cached 2 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 13:44:56,230 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:44:56,233 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 13:44:58,678 - database - [INFO] - database.py:965 - Cached 2 emails for account hprjiocj465@outlook.com
2025-10-31 13:44:58,684 - email_service - [INFO] - email_service.py:218 - Cached 2 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 13:52:51,400 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 13:52:51,402 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 13:52:53,754 - database - [INFO] - database.py:965 - Cached 2 emails for account hprjiocj465@outlook.com
2025-10-31 13:52:53,784 - email_service - [INFO] - email_service.py:218 - Cached 2 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 14:25:18,530 - root - [INFO] - main.py:161 - Shutting down Outlook邮件API服务...
2025-10-31 14:25:18,531 - root - [INFO] - main.py:168 - Token refresh background task cancelled
2025-10-31 14:25:18,532 - root - [INFO] - main.py:170 - Closing IMAP connection pool...
2025-10-31 14:29:25,927 - root - [INFO] - logger_config.py:49 - Logging system initialized
2025-10-31 14:29:26,514 - root - [INFO] - main.py:242 - Starting Outlook邮件API服务 on 0.0.0.0:8000
2025-10-31 14:29:26,515 - root - [INFO] - main.py:243 - Access the web interface at: http://localhost:8000
2025-10-31 14:29:26,515 - root - [INFO] - main.py:244 - Access the API documentation at: http://localhost:8000/docs
2025-10-31 14:29:26,930 - root - [INFO] - main.py:138 - Starting Outlook邮件API服务 v2.0.0...
2025-10-31 14:29:26,932 - root - [INFO] - main.py:141 - Initializing database...
2025-10-31 14:29:26,941 - database - [INFO] - database.py:132 - Database initialized successfully
2025-10-31 14:29:26,947 - root - [INFO] - main.py:143 - Database initialized successfully
2025-10-31 14:29:26,965 - database - [INFO] - database.py:759 - API Key already exists
2025-10-31 14:29:26,966 - root - [INFO] - main.py:150 - API Key initialized
2025-10-31 14:29:26,968 - root - [INFO] - main.py:156 - Token refresh background task scheduled
2025-10-31 14:29:26,969 - root - [INFO] - main.py:46 - Token refresh background task started
2025-10-31 14:29:26,970 - root - [INFO] - main.py:50 - Starting scheduled token refresh for all accounts...
2025-10-31 14:29:36,790 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 14:29:36,800 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 14:29:36,832 - database - [INFO] - database.py:405 - Updated account: hprjiocj465@outlook.com
2025-10-31 14:29:36,858 - root - [INFO] - main.py:96 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 14:29:48,501 - passlib.handlers.bcrypt - [WARNING] - bcrypt.py:622 - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "D:\programming\practice\python\OutlookManager2\venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-10-31 14:29:48,991 - routes.auth_routes - [INFO] - auth_routes.py:39 - Admin admin logged in successfully
2025-10-31 14:29:50,013 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 14:29:50,016 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 14:29:50,049 - database - [INFO] - database.py:405 - Updated account: hnybirs6215@outlook.com
2025-10-31 14:29:50,055 - root - [INFO] - main.py:96 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 14:29:50,056 - root - [INFO] - main.py:115 - Token refresh completed: 2 succeeded, 0 failed
2025-10-31 14:29:53,345 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 14:29:53,346 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 14:29:53,347 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 14:29:53,348 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 14:29:53,348 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 14:29:53,349 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 14:29:53,350 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 14:29:53,352 - database - [INFO] - database.py:310 - [筛选] SQL WHERE子句: 1=1
2025-10-31 14:29:53,357 - database - [INFO] - database.py:311 - [筛选] SQL参数: []
2025-10-31 14:29:53,359 - database - [INFO] - database.py:317 - [筛选] 符合条件的总数: 2
2025-10-31 14:29:53,397 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 14:29:55,715 - email_service - [INFO] - email_service.py:58 - Returning 2 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:31:00,515 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 14:31:00,516 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 14:31:03,029 - imap_pool - [INFO] - imap_pool.py:73 - Successfully created IMAP connection for hprjiocj465@outlook.com
2025-10-31 14:31:04,920 - verification_code_detector - [INFO] - verification_code_detector.py:67 - 验证码检测器初始化完成
2025-10-31 14:31:05,936 - database - [INFO] - database.py:965 - Cached 3 emails for account hprjiocj465@outlook.com
2025-10-31 14:31:05,942 - email_service - [INFO] - email_service.py:229 - Cached 3 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 14:31:56,093 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:32:18,003 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 14:32:18,004 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 14:32:19,292 - email_service - [INFO] - email_service.py:334 - Detected verification code in email Junk-1: 267486
2025-10-31 14:32:19,571 - database - [INFO] - database.py:1096 - Cached email detail for hprjiocj465@outlook.com: Junk-1
2025-10-31 14:32:19,577 - email_service - [INFO] - email_service.py:355 - Cached email detail to SQLite for Junk-1
2025-10-31 14:32:56,102 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:33:55,792 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:34:56,087 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:35:55,799 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:36:58,115 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:37:57,800 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:38:58,121 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:39:21,642 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 14:39:21,643 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 14:39:24,724 - database - [INFO] - database.py:965 - Cached 3 emails for account hprjiocj465@outlook.com
2025-10-31 14:39:24,737 - email_service - [INFO] - email_service.py:229 - Cached 3 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 14:39:56,090 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:40:21,562 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 14:40:21,563 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 14:40:24,708 - database - [INFO] - database.py:965 - Cached 3 emails for account hprjiocj465@outlook.com
2025-10-31 14:40:24,713 - email_service - [INFO] - email_service.py:229 - Cached 3 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 14:40:56,046 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:41:55,834 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:42:58,111 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:43:57,832 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:44:43,315 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 14:44:43,317 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 14:44:43,319 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 14:44:43,320 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 14:44:43,321 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 14:44:43,322 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 14:44:43,324 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 14:44:43,326 - database - [INFO] - database.py:310 - [筛选] SQL WHERE子句: 1=1
2025-10-31 14:44:43,327 - database - [INFO] - database.py:311 - [筛选] SQL参数: []
2025-10-31 14:44:43,330 - database - [INFO] - database.py:317 - [筛选] 符合条件的总数: 2
2025-10-31 14:44:43,438 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 14:44:45,665 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:44:54,635 - email_service - [INFO] - email_service.py:275 - Returning cached email detail from SQLite for Junk-1
2025-10-31 14:45:18,458 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 14:45:18,460 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 14:45:21,798 - database - [INFO] - database.py:965 - Cached 3 emails for account hprjiocj465@outlook.com
2025-10-31 14:45:21,804 - email_service - [INFO] - email_service.py:229 - Cached 3 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 14:45:29,358 - email_service - [INFO] - email_service.py:275 - Returning cached email detail from SQLite for Junk-1
2025-10-31 14:45:35,867 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 14:45:35,867 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 14:45:35,868 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 14:45:35,869 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 14:45:35,869 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 14:45:35,870 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 14:45:35,876 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 14:45:35,879 - database - [INFO] - database.py:310 - [筛选] SQL WHERE子句: 1=1
2025-10-31 14:45:35,884 - database - [INFO] - database.py:311 - [筛选] SQL参数: []
2025-10-31 14:45:35,887 - database - [INFO] - database.py:317 - [筛选] 符合条件的总数: 2
2025-10-31 14:45:35,898 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 14:45:37,538 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:46:43,833 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 14:46:43,835 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 14:46:47,132 - database - [INFO] - database.py:965 - Cached 3 emails for account hprjiocj465@outlook.com
2025-10-31 14:46:47,138 - email_service - [INFO] - email_service.py:229 - Cached 3 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 14:47:11,534 - email_service - [INFO] - email_service.py:275 - Returning cached email detail from SQLite for Junk-1
2025-10-31 14:47:38,127 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:47:50,498 - root - [INFO] - main.py:161 - Shutting down Outlook邮件API服务...
2025-10-31 14:47:50,499 - root - [INFO] - main.py:168 - Token refresh background task cancelled
2025-10-31 14:47:50,499 - root - [INFO] - main.py:170 - Closing IMAP connection pool...
2025-10-31 14:48:29,805 - root - [INFO] - logger_config.py:49 - Logging system initialized
2025-10-31 14:48:30,316 - root - [INFO] - main.py:242 - Starting Outlook邮件API服务 on 0.0.0.0:8000
2025-10-31 14:48:30,316 - root - [INFO] - main.py:243 - Access the web interface at: http://localhost:8000
2025-10-31 14:48:30,317 - root - [INFO] - main.py:244 - Access the API documentation at: http://localhost:8000/docs
2025-10-31 14:48:30,688 - root - [INFO] - main.py:138 - Starting Outlook邮件API服务 v2.0.0...
2025-10-31 14:48:30,689 - root - [INFO] - main.py:141 - Initializing database...
2025-10-31 14:48:30,714 - database - [INFO] - database.py:110 - Added verification_code column to emails_cache table
2025-10-31 14:48:30,740 - database - [INFO] - database.py:136 - Added verification_code column to email_details_cache table
2025-10-31 14:48:30,744 - database - [INFO] - database.py:150 - Database initialized successfully
2025-10-31 14:48:30,750 - root - [INFO] - main.py:143 - Database initialized successfully
2025-10-31 14:48:30,767 - database - [INFO] - database.py:777 - API Key already exists
2025-10-31 14:48:30,767 - root - [INFO] - main.py:150 - API Key initialized
2025-10-31 14:48:30,768 - root - [INFO] - main.py:156 - Token refresh background task scheduled
2025-10-31 14:48:30,770 - root - [INFO] - main.py:46 - Token refresh background task started
2025-10-31 14:48:30,771 - root - [INFO] - main.py:50 - Starting scheduled token refresh for all accounts...
2025-10-31 14:48:40,189 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 14:48:40,191 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 14:48:40,219 - database - [INFO] - database.py:423 - Updated account: hprjiocj465@outlook.com
2025-10-31 14:48:40,226 - root - [INFO] - main.py:96 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 14:48:51,783 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 14:48:51,785 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 14:48:51,817 - database - [INFO] - database.py:423 - Updated account: hnybirs6215@outlook.com
2025-10-31 14:48:51,824 - root - [INFO] - main.py:96 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 14:48:51,826 - root - [INFO] - main.py:115 - Token refresh completed: 2 succeeded, 0 failed
2025-10-31 14:49:02,223 - passlib.handlers.bcrypt - [WARNING] - bcrypt.py:622 - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "D:\programming\practice\python\OutlookManager2\venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-10-31 14:49:02,839 - routes.auth_routes - [INFO] - auth_routes.py:39 - Admin admin logged in successfully
2025-10-31 14:49:07,735 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 14:49:07,736 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 14:49:07,736 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 14:49:07,737 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 14:49:07,737 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 14:49:07,741 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 14:49:07,743 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 14:49:07,749 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 14:49:07,754 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 14:49:07,764 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 14:49:07,782 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 14:49:09,478 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:50:10,102 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:51:09,788 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:52:10,098 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:53:09,804 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:54:10,094 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:54:52,070 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 14:54:52,073 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 14:54:52,076 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 14:54:52,077 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 14:54:52,082 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 14:54:52,083 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 14:54:52,084 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 14:54:52,091 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 14:54:52,094 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 14:54:52,100 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 14:54:52,117 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 14:54:53,332 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:54:56,229 - email_service - [INFO] - email_service.py:275 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 14:54:58,590 - email_service - [INFO] - email_service.py:275 - Returning cached email detail from SQLite for Junk-1
2025-10-31 14:55:54,107 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:56:53,363 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:57:09,060 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:57:11,812 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:57:53,940 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:58:28,078 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:59:30,620 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 14:59:30,621 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 14:59:30,622 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 14:59:30,690 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 14:59:30,691 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 14:59:30,692 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 14:59:30,694 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 14:59:30,696 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 14:59:30,697 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 14:59:30,701 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 14:59:30,708 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 14:59:40,660 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 14:59:50,788 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:00:01,178 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:00:10,867 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:00:21,105 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:00:30,793 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:00:40,629 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:00:50,305 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:01:00,627 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:01:10,802 - email_service - [INFO] - email_service.py:58 - Returning 3 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:01:27,439 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:01:27,440 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:01:29,875 - imap_pool - [INFO] - imap_pool.py:73 - Successfully created IMAP connection for hprjiocj465@outlook.com
2025-10-31 15:01:31,646 - verification_code_detector - [INFO] - verification_code_detector.py:67 - 验证码检测器初始化完成
2025-10-31 15:01:32,608 - database - [INFO] - database.py:984 - Cached 4 emails for account hprjiocj465@outlook.com
2025-10-31 15:01:32,614 - email_service - [INFO] - email_service.py:229 - Cached 4 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:02:02,954 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 15:02:02,977 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 15:02:02,978 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 15:02:03,008 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 15:02:03,017 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 15:02:03,027 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 15:02:03,030 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 15:02:03,039 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 15:02:03,043 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 15:02:03,046 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 15:02:03,055 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 15:02:08,826 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 15:02:08,827 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 15:02:08,828 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 15:02:08,829 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 15:02:08,830 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 15:02:08,831 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 15:02:08,832 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 15:02:08,835 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 15:02:08,836 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 15:02:08,839 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 15:02:08,847 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 15:02:10,005 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:02:20,784 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:02:31,093 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:02:40,791 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:02:48,600 - root - [INFO] - main.py:161 - Shutting down Outlook邮件API服务...
2025-10-31 15:02:48,601 - root - [INFO] - main.py:168 - Token refresh background task cancelled
2025-10-31 15:02:48,602 - root - [INFO] - main.py:170 - Closing IMAP connection pool...
2025-10-31 15:03:10,811 - root - [INFO] - logger_config.py:49 - Logging system initialized
2025-10-31 15:03:11,153 - root - [INFO] - main.py:242 - Starting Outlook邮件API服务 on 0.0.0.0:8000
2025-10-31 15:03:11,154 - root - [INFO] - main.py:243 - Access the web interface at: http://localhost:8000
2025-10-31 15:03:11,154 - root - [INFO] - main.py:244 - Access the API documentation at: http://localhost:8000/docs
2025-10-31 15:03:11,381 - root - [INFO] - main.py:138 - Starting Outlook邮件API服务 v2.0.0...
2025-10-31 15:03:11,382 - root - [INFO] - main.py:141 - Initializing database...
2025-10-31 15:03:11,392 - database - [INFO] - database.py:150 - Database initialized successfully
2025-10-31 15:03:11,398 - root - [INFO] - main.py:143 - Database initialized successfully
2025-10-31 15:03:11,426 - database - [INFO] - database.py:777 - API Key already exists
2025-10-31 15:03:11,427 - root - [INFO] - main.py:150 - API Key initialized
2025-10-31 15:03:11,428 - root - [INFO] - main.py:156 - Token refresh background task scheduled
2025-10-31 15:03:11,429 - root - [INFO] - main.py:46 - Token refresh background task started
2025-10-31 15:03:11,430 - root - [INFO] - main.py:50 - Starting scheduled token refresh for all accounts...
2025-10-31 15:03:22,052 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:03:22,054 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 15:03:22,084 - database - [INFO] - database.py:423 - Updated account: hprjiocj465@outlook.com
2025-10-31 15:03:22,090 - root - [INFO] - main.py:96 - Successfully refreshed token for hprjiocj465@outlook.com
2025-10-31 15:03:33,677 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:03:33,680 - oauth_service - [INFO] - oauth_service.py:128 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 15:03:33,712 - database - [INFO] - database.py:423 - Updated account: hnybirs6215@outlook.com
2025-10-31 15:03:33,718 - root - [INFO] - main.py:96 - Successfully refreshed token for hnybirs6215@outlook.com
2025-10-31 15:03:33,718 - root - [INFO] - main.py:115 - Token refresh completed: 2 succeeded, 0 failed
2025-10-31 15:03:40,737 - passlib.handlers.bcrypt - [WARNING] - bcrypt.py:622 - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "D:\programming\practice\python\OutlookManager2\venv\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-10-31 15:03:41,386 - routes.auth_routes - [INFO] - auth_routes.py:39 - Admin admin logged in successfully
2025-10-31 15:03:44,472 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 15:03:44,473 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 15:03:44,473 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 15:03:44,474 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 15:03:44,475 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 15:03:44,476 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 15:03:44,477 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 15:03:44,479 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 15:03:44,479 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 15:03:44,482 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 15:03:44,488 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 15:03:46,847 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:03:57,672 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:04:08,780 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:04:16,865 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:04:27,782 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:04:37,791 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:04:48,097 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:04:57,332 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:05:05,396 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:05:06,862 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:05:07,724 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:05:10,628 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-2
2025-10-31 15:05:13,643 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 15:05:16,863 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:05:27,808 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:05:41,788 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 15:05:41,789 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 15:05:41,789 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 15:05:41,790 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 15:05:41,791 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 15:05:41,791 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 15:05:41,792 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 15:05:41,794 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 15:05:41,795 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 15:05:41,797 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 15:05:41,811 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 15:05:42,930 - email_service - [INFO] - email_service.py:58 - Returning 4 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:06:04,802 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:06:04,804 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:06:07,225 - imap_pool - [INFO] - imap_pool.py:73 - Successfully created IMAP connection for hprjiocj465@outlook.com
2025-10-31 15:06:09,031 - verification_code_detector - [INFO] - verification_code_detector.py:67 - 验证码检测器初始化完成
2025-10-31 15:06:09,976 - database - [INFO] - database.py:984 - Cached 5 emails for account hprjiocj465@outlook.com
2025-10-31 15:06:09,981 - email_service - [INFO] - email_service.py:238 - Cached 5 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:06:25,477 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:06:25,482 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:06:28,340 - database - [INFO] - database.py:984 - Cached 5 emails for account hprjiocj465@outlook.com
2025-10-31 15:06:28,346 - email_service - [INFO] - email_service.py:238 - Cached 5 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:06:43,566 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:06:43,570 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:06:46,620 - database - [INFO] - database.py:984 - Cached 5 emails for account hprjiocj465@outlook.com
2025-10-31 15:06:46,627 - email_service - [INFO] - email_service.py:238 - Cached 5 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:07:05,015 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:07:05,017 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:07:08,055 - database - [INFO] - database.py:984 - Cached 5 emails for account hprjiocj465@outlook.com
2025-10-31 15:07:08,063 - email_service - [INFO] - email_service.py:238 - Cached 5 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:07:26,132 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:07:26,137 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:07:29,298 - database - [INFO] - database.py:984 - Cached 5 emails for account hprjiocj465@outlook.com
2025-10-31 15:07:29,304 - email_service - [INFO] - email_service.py:238 - Cached 5 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:08:09,304 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:08:09,307 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:08:12,158 - database - [INFO] - database.py:984 - Cached 5 emails for account hprjiocj465@outlook.com
2025-10-31 15:08:12,164 - email_service - [INFO] - email_service.py:238 - Cached 5 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:09:10,697 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:09:10,706 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:09:13,665 - database - [INFO] - database.py:984 - Cached 5 emails for account hprjiocj465@outlook.com
2025-10-31 15:09:13,671 - email_service - [INFO] - email_service.py:238 - Cached 5 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:09:34,390 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for Junk-1
2025-10-31 15:09:35,161 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:09:35,166 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:09:37,984 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:09:37,993 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:09:46,414 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for Junk-1
2025-10-31 15:09:47,142 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:09:47,144 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:09:50,811 - email_service - [INFO] - email_service.py:343 - Detected verification code in email INBOX-3: 451246
2025-10-31 15:09:51,066 - database - [INFO] - database.py:1117 - Cached email detail for hprjiocj465@outlook.com: INBOX-3
2025-10-31 15:09:51,071 - email_service - [INFO] - email_service.py:364 - Cached email detail to SQLite for INBOX-3
2025-10-31 15:10:01,896 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-3
2025-10-31 15:10:02,812 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:10:02,814 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:10:05,673 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:10:05,680 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:10:22,595 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:10:22,596 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:10:25,613 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:10:25,619 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:10:45,361 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:10:45,363 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:10:48,190 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:10:48,197 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:11:03,613 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 15:11:03,614 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 15:11:03,615 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 15:11:03,617 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 15:11:03,618 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 15:11:03,619 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 15:11:03,621 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 15:11:03,623 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 15:11:03,626 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 15:11:03,629 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 15:11:03,637 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 15:11:04,491 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:11:04,494 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:11:07,545 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:11:07,554 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:12:06,408 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 15:12:06,409 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 15:12:06,410 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 15:12:06,410 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 15:12:06,411 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 15:12:06,411 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 15:12:06,412 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 15:12:06,414 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 15:12:06,415 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 15:12:06,418 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 15:12:06,426 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 15:12:12,780 - email_service - [INFO] - email_service.py:58 - Returning 6 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:12:34,427 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:12:34,475 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:12:34,973 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:12:34,975 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:12:37,295 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:12:37,301 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:12:37,366 - imap_pool - [INFO] - imap_pool.py:73 - Successfully created IMAP connection for hprjiocj465@outlook.com
2025-10-31 15:12:38,158 - email_service - [INFO] - email_service.py:343 - Detected verification code in email INBOX-5: 1231123
2025-10-31 15:12:38,411 - database - [INFO] - database.py:1117 - Cached email detail for hprjiocj465@outlook.com: INBOX-5
2025-10-31 15:12:38,420 - email_service - [INFO] - email_service.py:364 - Cached email detail to SQLite for INBOX-5
2025-10-31 15:12:53,619 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-5
2025-10-31 15:12:54,326 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:12:54,329 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:12:57,075 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-5
2025-10-31 15:12:57,325 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:12:57,331 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:12:59,227 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-5
2025-10-31 15:13:01,435 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for Junk-1
2025-10-31 15:13:12,141 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-3
2025-10-31 15:13:12,858 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:13:12,860 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:13:15,728 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:13:15,734 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:13:23,351 - routes.auth_routes - [INFO] - auth_routes.py:39 - Admin admin logged in successfully
2025-10-31 15:13:34,284 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:13:34,285 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:13:37,287 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:13:37,295 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:13:52,700 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:13:52,702 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:13:55,637 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:13:55,645 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:16:15,206 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 15:16:15,208 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 15:16:15,209 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 15:16:15,210 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 15:16:15,211 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 15:16:15,211 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 15:16:15,212 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 15:16:15,214 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 15:16:15,217 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 15:16:15,220 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 15:16:15,228 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 15:16:16,741 - email_service - [INFO] - email_service.py:58 - Returning 6 cached emails from SQLite for hprjiocj465@outlook.com
2025-10-31 15:16:18,795 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-5
2025-10-31 15:16:21,886 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-3
2025-10-31 15:16:48,590 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:16:48,592 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:16:48,618 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:16:48,620 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:16:49,722 - email_service - [INFO] - email_service.py:343 - Detected verification code in email INBOX-4: 45124622
2025-10-31 15:16:49,976 - database - [INFO] - database.py:1117 - Cached email detail for hprjiocj465@outlook.com: INBOX-4
2025-10-31 15:16:49,983 - email_service - [INFO] - email_service.py:364 - Cached email detail to SQLite for INBOX-4
2025-10-31 15:16:51,497 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:16:51,505 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:16:55,194 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-3
2025-10-31 15:17:07,017 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-2
2025-10-31 15:17:07,617 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:17:07,620 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:17:10,911 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:17:10,919 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:17:29,059 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-2
2025-10-31 15:17:29,143 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-1
2025-10-31 15:17:29,778 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:17:29,779 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:17:31,468 - email_service - [INFO] - email_service.py:284 - Returning cached email detail from SQLite for INBOX-2
2025-10-31 15:17:32,696 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:17:32,701 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:17:47,224 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 15:17:47,225 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 15:17:47,225 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 15:17:47,226 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 15:17:47,226 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 15:17:47,227 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 15:17:47,227 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 15:17:47,229 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 15:17:47,229 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 15:17:47,231 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 15:17:47,238 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 15:17:47,390 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 15:17:47,391 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 15:17:47,391 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 15:17:47,392 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 15:17:47,393 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 15:17:47,393 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 15:17:47,394 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 15:17:47,397 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 15:17:47,397 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 15:17:47,400 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 15:17:47,407 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 15:17:47,859 - httpx - [INFO] - _client.py:1773 - HTTP Request: POST https://login.microsoftonline.com/consumers/oauth2/v2.0/token "HTTP/1.1 200 OK"
2025-10-31 15:17:47,861 - oauth_service - [INFO] - oauth_service.py:57 - Successfully obtained access token for hprjiocj465@outlook.com
2025-10-31 15:17:49,699 - routes.account_routes - [INFO] - account_routes.py:108 - [API] GET /accounts 收到请求:
2025-10-31 15:17:49,700 - routes.account_routes - [INFO] - account_routes.py:109 -   page=1, page_size=10
2025-10-31 15:17:49,701 - routes.account_routes - [INFO] - account_routes.py:110 -   email_search=None, tag_search=None
2025-10-31 15:17:49,702 - routes.account_routes - [INFO] - account_routes.py:111 -   refresh_status=None, time_filter=None
2025-10-31 15:17:49,703 - routes.account_routes - [INFO] - account_routes.py:112 -   after_date=None
2025-10-31 15:17:49,703 - routes.account_routes - [INFO] - account_routes.py:113 -   refresh_start_date=None
2025-10-31 15:17:49,709 - routes.account_routes - [INFO] - account_routes.py:114 -   refresh_end_date=None
2025-10-31 15:17:49,712 - database - [INFO] - database.py:328 - [筛选] SQL WHERE子句: 1=1
2025-10-31 15:17:49,713 - database - [INFO] - database.py:329 - [筛选] SQL参数: []
2025-10-31 15:17:49,716 - database - [INFO] - database.py:335 - [筛选] 符合条件的总数: 2
2025-10-31 15:17:49,723 - routes.account_routes - [INFO] - account_routes.py:129 - [API] 查询结果: 总数=2, 返回=2条
2025-10-31 15:17:50,700 - database - [INFO] - database.py:984 - Cached 6 emails for account hprjiocj465@outlook.com
2025-10-31 15:17:50,710 - email_service - [INFO] - email_service.py:238 - Cached 6 emails to SQLite for hprjiocj465@outlook.com
2025-10-31 15:17:52,993 - root - [INFO] - main.py:161 - Shutting down Outlook邮件API服务...
2025-10-31 15:17:52,994 - root - [INFO] - main.py:168 - Token refresh background task cancelled
2025-10-31 15:17:52,995 - root - [INFO] - main.py:170 - Closing IMAP connection pool...
