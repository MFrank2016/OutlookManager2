"""
修复中文乱码的脚本
"""

import os
import re

# 乱码到正确中文的映射
replacements = {
    # 常见乱码映射
    '宸︿晶鑿滃崟': '左侧菜单',
    '閭欢绠＄悊': '邮件管理',
    'Outlook閭欢绠＄悊绯荤粺': 'Outlook邮件管理系统',
    '閭璐︽埛': '邮箱账户',
    '娣诲姞璐︽埛': '添加账户',
    '鎵归噺娣诲姞': '批量添加',
    '绠＄悊闈㈡澘': '管理面板',
    'API绠＄悊': 'API管理',
    'API鏂囨。': 'API文档',
    '閭欢鍒楄〃': '邮件列表',
    '涓诲唴瀹瑰尯鍩?': '主内容区域',
    '閭璐︽埛绠＄悊': '邮箱账户管理',
    '绠＄悊鎵€鏈夊凡娣诲姞鐨勯偖绠辫处鎴?': '管理所有已添加的邮箱账户',
    '鍒锋柊鍒楄〃': '刷新列表',
    '鎵归噺鍒锋柊Token': '批量刷新Token',
    '鎼滅储鍜岃繃婊ゅ尯鍩?': '搜索和过滤区域',
    '鎸夐偖绠辫处鍙锋悳绱?': '按邮箱账号搜索',
    '鎸夋爣绛炬悳绱?': '按标签搜索',
    '鍏ㄩ儴鐘舵€?': '全部状态',
    '浠庢湭鍒锋柊': '从未刷新',
    '鍒锋柊澶辫触': '刷新失败',
    '鍒锋柊鎴愬姛': '刷新成功',
    '鎸囧畾鍒锋柊鏉′欢': '指定刷新条件',
    '鎼滅储': '搜索',
    '娓呴櫎': '清除',
    '鑷畾涔夋棩鏈熻寖鍥撮€夋嫨': '自定义日期范围选择',
    '鍒锋柊璧峰鏃堕棿': '刷新起始时间',
    '鍒锋柊鎴鏃堕棿': '刷新截止时间',
    '搴旂敤绛涢€?': '应用筛选',
    '缁熻淇℃伅': '统计信息',
    '鎬绘暟': '总数',
    '褰撳墠椤?': '当前页',
    '姣忛〉': '每页',
    '姝ｅ湪鍔犺浇璐︽埛鍒楄〃': '正在加载账户列表',
    '鍒嗛〉鎺т欢': '分页控件',
    '涓婁竴椤?': '上一页',
    '涓嬩竴椤?': '下一页',
    '娣诲姞鍗曚釜璐︽埛椤甸潰': '添加单个账户页面',
    '娣诲姞閭璐︽埛': '添加邮箱账户',
    '娣诲姞鍗曚釜Outlook閭璐︽埛鍒扮郴缁?': '添加单个Outlook邮箱账户到系统',
    '杩斿洖鍒楄〃': '返回列表',
    '閭鍦板潃': '邮箱地址',
    '璇疯緭鍏ユ湁鏁堢殑Outlook閭鍦板潃': '请输入有效的Outlook邮箱地址',
    '鍒锋柊浠ょ墝': '刷新令牌',
    'Refresh Token': 'Refresh Token',
    '浠嶢zure搴旂敤鑾峰彇鐨剅efresh_token': '从Azure应用获取的refresh_token',
    '瀹㈡埛绔疘D': '客户端ID',
    'Client ID': 'Client ID',
    'Azure搴旂敤鐨刢lient_id': 'Azure应用的client_id',
    'Azure搴旂敤绋嬪簭鐨勫鎴风鏍囪瘑绗?': 'Azure应用程序的客户端标识符',
    '鑾峰彇姝ラ': '获取步骤',
    '璁块棶': '访问',
    'Azure Portal': 'Azure Portal',
    '娉ㄥ唽搴旂敤绋嬪簭骞堕厤缃潈闄?': '注册应用程序并配置权限',
    '鑾峰彇Client ID鍜孯efresh Token': '获取Client ID和Refresh Token',
    '纭繚搴旂敤鏈夐偖浠惰鍙栨潈闄?': '确保应用有邮件读取权限',
    '鏍囩': '标签',
    '鍙€?': '可选',
    '鐢ㄩ€楀彿鍒嗛殧': '用逗号分隔',
    '宸ヤ綔': '工作',
    '涓汉': '个人',
    '閲嶈': '重要',
    '娓呯┖琛ㄥ崟': '清空表单',
    '娴嬭瘯杩炴帴': '测试连接',
    '鎵归噺娣诲姞閭璐︽埛椤甸潰': '批量添加邮箱账户页面',
    '鎵归噺娣诲姞閭璐︽埛': '批量添加邮箱账户',
    '涓€娆℃€ф坊鍔犲涓偖绠辫处鎴峰埌绯荤粺': '一次性添加多个邮箱账户到系统',
    '鎵归噺璐︽埛淇℃伅': '批量账户信息',
    '姣忚鏍煎紡': '每行格式',
    '閭----瀵嗙爜----鍒锋柊浠ょ墝----瀹㈡埛绔疘D': '邮箱----密码----刷新令牌----客户端ID',
    '鎺ㄨ崘璐拱鍦板潃': '推荐购买地址',
    '闈炲箍鍛?': '非广告',
    '鍙槸鎺ㄨ崘': '只是推荐',
    '鎻愮ず': '提示',
    '娉ㄦ剰浜嬮』': '注意事项',
    '纭繚鎵€鏈夎处鎴蜂俊鎭牸寮忔纭?': '确保所有账户信息格式正确',
    '寤鸿鍏堟祴璇曞皯閲忚处鎴峰啀鎵归噺娣诲姞': '建议先测试少量账户再批量添加',
    '娣诲姞杩囩▼涓鍕垮叧闂〉闈?': '添加过程中请勿关闭页面',
    '澶辫触鐨勮处鎴蜂細鍦ㄧ粨鏋滀腑鏄剧ず': '失败的账户会在结果中显示',
    '寮€濮嬫壒閲忔坊鍔?': '开始批量添加',
    '楠岃瘉鏍煎紡': '验证格式',
    '鍔犺浇绀轰緥': '加载示例',
    '娣诲姞杩涘害': '添加进度',
    '鍑嗗涓?': '准备中',
    '娣诲姞缁撴灉': '添加结果',
    '绯荤粺绠＄悊闈㈡澘': '系统管理面板',
    '绠＄悊鏁版嵁搴撹〃鍜岀郴缁熼厤缃?': '管理数据库表和系统配置',
    '鏁版嵁琛ㄧ鐞?': '数据表管理',
    '绯荤粺閰嶇疆': '系统配置',
    '鏁版嵁搴撹〃鍒楄〃': '数据库表列表',
    '姝ｅ湪鍔犺浇琛ㄥ垪琛?': '正在加载表列表',
    '琛ㄦ暟鎹?': '表数据',
    '褰撳墠琛ㄥ悕': '当前表名',
    '娣诲姞璁板綍': '添加记录',
    '鍒锋柊': '刷新',
    '杩斿洖': '返回',
    '鎼滅储琛ㄦ暟鎹?': '搜索表数据',
    '姝ｅ湪鍔犺浇鏁版嵁': '正在加载数据',
    '绯荤粺閰嶇疆绠＄悊': '系统配置管理',
    '绯荤粺閰嶇疆椤?': '系统配置项',
    '閰嶇疆IMAP鏈嶅姟鍣ㄣ€佽繛鎺ユ睜銆佺紦瀛樼瓑绯荤粺鍙傛暟': '配置IMAP服务器、连接池、缓存等系统参数',
    '姝ｅ湪鍔犺浇閰嶇疆': '正在加载配置',
    'API鎺ュ彛鏂囨。': 'API接口文档',
    '閭欢绠＄悊绯荤粺鐨凴ESTful API鎺ュ彛璇存槑': '邮件管理系统的RESTful API接口说明',
    '澶嶅埗Base URL': '复制Base URL',
    '涓嬭浇鏂囨。': '下载文档',
    'API鍩虹淇℃伅': 'API基础信息',
    '璁よ瘉鏂瑰紡': '认证方式',
    'JWT Token璁よ瘉': 'JWT Token认证',
    '鎵€鏈堿PI閮介渶瑕佸湪璇锋眰澶翠腑鎼哄甫JWT Token': '所有API都需要在请求头中携带JWT Token',
    '閫氳繃': '通过',
    '鎺ュ彛鑾峰彇Token': '接口获取Token',
    'Token鏈夋晥鏈熶负24灏忔椂': 'Token有效期为24小时',
    '鍝嶅簲鏍煎紡': '响应格式',
    '鎵€鏈夋帴鍙ｈ繑鍥濲SON鏍煎紡鏁版嵁': '所有接口返回JSON格式数据',
    'HTTP鐘舵€佺爜琛ㄧず璇锋眰缁撴灉': 'HTTP状态码表示请求结果',
    '鎴愬姛': '成功',
    '鏈璇佹垨Token杩囨湡': '未认证或Token过期',
    '璧勬簮涓嶅瓨鍦?': '资源不存在',
    '璇锋眰鍙傛暟閿欒': '请求参数错误',
    '鏈嶅姟鍣ㄥ唴閮ㄩ敊璇?': '服务器内部错误',
    '鐗堟湰淇℃伅': '版本信息',
    '褰撳墠鐗堟湰': '当前版本',
    '鏂板鍔熻兘': '新增功能',
    'JWT璁よ瘉': 'JWT认证',
    '鏃ュ織绯荤粺': '日志系统',
    'SQLite瀛樺偍': 'SQLite存储',
    '绠＄悊闈㈡澘': '管理面板',
    '璁よ瘉绠＄悊': '认证管理',
    '绠＄悊鍛樼櫥褰?': '管理员登录',
    '杩斿洖JWT璁块棶浠ょ墝': '返回JWT访问令牌',
    '璇锋眰浣?': '请求体',
    '鍝嶅簲绀轰緥': '响应示例',
    '鑾峰彇褰撳墠鐢ㄦ埛淇℃伅': '获取当前用户信息',
    '鑾峰彇褰撳墠鐧诲綍鐨勭鐞嗗憳淇℃伅': '获取当前登录的管理员信息',
    '闇€瑕丣WT璁よ瘉': '需要JWT认证',
    '淇敼瀵嗙爜': '修改密码',
    '淇敼绠＄悊鍛樺瘑鐮?': '修改管理员密码',
    '鏃у瘑鐮?': '旧密码',
    '鏂板瘑鐮?': '新密码',
    '瀵嗙爜淇敼鎴愬姛': '密码修改成功',
    '璐︽埛绠＄悊': '账户管理',
    '鑾峰彇閭鍒楄〃鎺ュ彛': '获取邮箱列表接口',
    '鑾峰彇绯荤粺涓墍鏈夊凡娣诲姞鐨勯偖绠辫处鎴峰垪琛?': '获取系统中所有已添加的邮箱账户列表',
    '鏀寔鍒嗛〉鍜屾ā绯婃悳绱?': '支持分页和模糊搜索',
    '璇锋眰鍙傛暟': '请求参数',
    '椤电爜': '页码',
    '浠?寮€濮?': '从1开始',
    '榛樿': '默认',
    '姣忛〉鏁伴噺': '每页数量',
    '鑼冨洿': '范围',
    '閭璐﹀彿妯＄硦鎼滅储': '邮箱账号模糊搜索',
    '鏍囩妯＄硦鎼滅储': '标签模糊搜索',
    '鍒锋柊鐘舵€佺瓫閫?': '刷新状态筛选',
    '鏃堕棿杩囨护鍣?': '时间过滤器',
    '鑷畾涔夋棩鏈?': '自定义日期',
    'ISO鏍煎紡': 'ISO格式',
    '涓巘ime_filter=custom閰嶅悎浣跨敤': '与time_filter=custom配合使用',
    '璺緞鍙傛暟': '路径参数',
    '閭鍦板潃': '邮箱地址',
    '闇€瑕乁RL缂栫爜': '需要URL编码',
    '璇锋眰绀轰緥': '请求示例',
    '鎵嬪姩鍒锋柊鎸囧畾璐︽埛鐨勮闂甌oken': '手动刷新指定账户的访问Token',
    '鐢ㄤ簬楠岃瘉璐︽埛鍑嵁鎴栨洿鏂拌繃鏈熺殑Token': '用于验证账户凭据或更新过期的Token',
    '鎵归噺鍒锋柊绗﹀悎绛涢€夋潯浠剁殑璐︽埛Token': '批量刷新符合筛选条件的账户Token',
    '鏀寔澶氱淮搴︾瓫閫?': '支持多维度筛选',
    '閭銆佹爣绛俱€佸埛鏂扮姸鎬併€佹椂闂磋寖鍥?': '邮箱、标签、刷新状态、时间范围',
    '鏌ヨ鍙傛暟': '查询参数',
    '鑾峰彇閭欢鍒楄〃鎺ュ彛': '获取邮件列表接口',
    '鑾峰彇鎸囧畾閭鐨勯偖浠跺垪琛?': '获取指定邮箱的邮件列表',
    '鏀寔鍒嗛〉鍜岃繃婊?': '支持分页和过滤',
    '閭欢鏂囦欢澶?': '邮件文件夹',
    '鍏ㄩ儴閭欢': '全部邮件',
    '鏀朵欢绠?': '收件箱',
    '鍨冨溇閭欢': '垃圾邮件',
    '鏄惁寮哄埗鍒锋柊缂撳瓨': '是否强制刷新缓存',
    '鑾峰彇閭欢璇︽儏鎺ュ彛': '获取邮件详情接口',
    '鑾峰彇鎸囧畾閭欢鐨勮缁嗗唴瀹?': '获取指定邮件的详细内容',
    '鍖呮嫭閭欢姝ｆ枃': '包括邮件正文',
    '閭欢ID': '邮件ID',
    '鏍煎紡': '格式',
    '鑾峰彇鍙屾爮瑙嗗浘閭欢': '获取双栏视图邮件',
    '鍚屾椂杩斿洖鏀朵欢绠卞拰鍨冨溇绠遍偖浠?': '同时返回收件箱和垃圾箱邮件',
    '鏀朵欢绠遍〉鐮?': '收件箱页码',
    '鍨冨溇绠遍〉鐮?': '垃圾箱页码',
    '娣诲姞璐︽埛': '添加账户',
    '娣诲姞鏂扮殑閭璐︽埛': '添加新的邮箱账户',
    '璐︽埛娣诲姞鎴愬姛': '账户添加成功',
    '鍒犻櫎璐︽埛': '删除账户',
    '鍒犻櫎鎸囧畾鐨勯偖绠辫处鎴?': '删除指定的邮箱账户',
    '璐︽埛鍒犻櫎鎴愬姛': '账户删除成功',
    '鏇存柊璐︽埛鏍囩': '更新账户标签',
    '鏇存柊鎸囧畾璐︽埛鐨勬爣绛惧垪琛?': '更新指定账户的标签列表',
    '娣诲姞璐︽埛鏍囩': '添加账户标签',
    '涓烘寚瀹氳处鎴锋坊鍔犲崟涓爣绛?': '为指定账户添加单个标签',
    '濡傛灉鏍囩宸插瓨鍦ㄥ垯涓嶅鐞?': '如果标签已存在则不处理',
    '骞傜瓑鎿嶄綔': '幂等操作',
    '鐗规€ц鏄?': '特性说明',
    '閲嶅娣诲姞鐩稿悓鏍囩涓嶄細鎶ラ敊': '重复添加相同标签不会报错',
    '鏍囩娣诲姞鍒扮幇鏈夋爣绛惧垪琛ㄦ湯灏?': '标签添加到现有标签列表末尾',
    '涓嶄細瑕嗙洊鐜版湁鏍囩': '不会覆盖现有标签',
    '璐︽埛涓嶅瓨鍦ㄦ椂杩斿洖404閿欒': '账户不存在时返回404错误',
    '闅忔満鑾峰彇閭': '随机获取邮箱',
    '闅忔満鑾峰彇閭璐︽埛鍒楄〃': '随机获取邮箱账户列表',
    '鏀寔鏍囩绛涢€夊拰鍒嗛〉': '支持标签筛选和分页',
    '姣忔璇锋眰杩斿洖鐨勯『搴忛兘鏄殢鏈虹殑': '每次请求返回的顺序都是随机的',
    '蹇呴』鍖呭惈鐨勬爣绛?': '必须包含的标签',
    '澶氫釜鐢ㄩ€楀彿鍒嗛殧': '多个用逗号分隔',
    '蹇呴』涓嶅寘鍚殑鏍囩': '必须不包含的标签',
    '浣跨敤鍦烘櫙': '使用场景',
    '闅忔満鍒嗛厤閭缁欎换鍔?': '随机分配邮箱给任务',
    '鎸夋爣绛鹃殢鏈烘娊鍙栭偖绠辫繘琛屾祴璇?': '按标签随机抽取邮箱进行测试',
    '閬垮厤閲嶅浣跨敤鍚屼竴鎵归偖绠?': '避免重复使用同一批邮箱',
    '瀹炵幇閭姹犵殑闅忔満杞崲': '实现邮箱池的随机轮换',
    '鍒锋柊Token': '刷新Token',
    '鎵嬪姩鍒锋柊鎸囧畾璐︽埛鐨勮闂甌oken': '手动刷新指定账户的访问Token',
    'Token鍒锋柊鎴愬姛': 'Token刷新成功',
    '绠＄悊闈㈡澘API': '管理面板API',
    '鑾峰彇琛ㄨ褰曟暟': '获取表记录数',
    '鑾峰彇鎸囧畾鏁版嵁琛ㄧ殑璁板綍鏁?': '获取指定数据表的记录数',
    '琛ㄥ悕': '表名',
    '鑾峰彇琛ㄦ暟鎹?': '获取表数据',
    '鑾峰彇鎸囧畾鏁版嵁琛ㄧ殑鎵€鏈夎褰?': '获取指定数据表的所有记录',
    '鍒犻櫎琛ㄨ褰?': '删除表记录',
    '鍒犻櫎鎸囧畾琛ㄤ腑鐨勮褰?': '删除指定表中的记录',
    '璁板綍ID': '记录ID',
    '璁板綍': '记录',
    '鍒犻櫎鎴愬姛': '删除成功',
    '鑾峰彇绯荤粺閰嶇疆': '获取系统配置',
    '鑾峰彇鎵€鏈夌郴缁熼厤缃」': '获取所有系统配置项',
    '鏇存柊绯荤粺閰嶇疆': '更新系统配置',
    '鍒涘缓鎴栨洿鏂扮郴缁熼厤缃」': '创建或更新系统配置项',
    '閰嶇疆': '配置',
    '鏇存柊鎴愬姛': '更新成功',
    '绯荤粺鐘舵€?': '系统状态',
    '绯荤粺淇℃伅': '系统信息',
    '鑾峰彇绯荤粺鐘舵€?': '获取系统状态',
    '鑾峰彇绯荤粺鐗堟湰鍜岀姸鎬佷俊鎭?': '获取系统版本和状态信息',
    '鏃犻渶璁よ瘉': '无需认证',
    '姝ｅ湪杩愯': '正在运行',
    '缂撳瓨绠＄悊': '缓存管理',
    '娓呴櫎鎸囧畾閭缂撳瓨': '清除指定邮箱缓存',
    '娓呴櫎鎸囧畾閭鐨勯偖浠跺垪琛ㄧ紦瀛?': '清除指定邮箱的邮件列表缓存',
    '娓呴櫎鎵€鏈夌紦瀛?': '清除所有缓存',
    '娓呴櫎鎵€鏈夐偖绠辩殑閭欢鍒楄〃缂撳瓨': '清除所有邮箱的邮件列表缓存',
    '褰撳墠璐︽埛': '当前账户',
    '鐐瑰嚮澶嶅埗閭鍦板潃': '点击复制邮箱地址',
    '鏈€鍚庢洿鏂?': '最后更新',
    '娓呴櫎缂撳瓨': '清除缓存',
    '瀵煎嚭': '导出',
    '杩斿洖璐︽埛': '返回账户',
    '鎬婚偖浠舵暟': '总邮件数',
    '鏈閭欢': '未读邮件',
    '浠婃棩閭欢': '今日邮件',
    '甯﹂檮浠?': '带附件',
    '鎼滅储鍙戜欢浜?': '搜索发件人',
    '鎼滅储涓婚': '搜索主题',
    '鏂囦欢澶?': '文件夹',
    '鎺掑簭': '排序',
    '鏃ユ湡鍊掑簭': '日期倒序',
    '鏈€鏂板湪鍓?': '最新在前',
    '鏃ユ湡姝ｅ簭': '日期正序',
    '鏈€鏃у湪鍓?': '最旧在前',
    '姣忛〉鏄剧ず': '每页显示',
    '鏉?': '条',
    '娓呴櫎鎼滅储': '清除搜索',
    '鍒嗛〉鎺т欢': '分页控件',
    '绗?': '第',
    '椤?': '页',
    '閭欢鍒楄〃琛ㄦ牸': '邮件列表表格',
    '鍙戜欢浜?': '发件人',
    '涓婚': '主题',
    '鏃ユ湡': '日期',
    '鎿嶄綔': '操作',
    '姝ｅ湪鍔犺浇閭欢': '正在加载邮件',
    '閫氱煡瀹瑰櫒': '通知容器',
    '閭欢璇︽儏妯℃€佹': '邮件详情模态框',
    '閭欢璇︽儏': '邮件详情',
    '姝ｅ湪鍔犺浇閭欢璇︽儏': '正在加载邮件详情',
    '鏍囩绠＄悊妯℃€佹': '标签管理模态框',
    '绠＄悊璐︽埛鏍囩': '管理账户标签',
    '褰撳墠鏍囩': '当前标签',
    '娣诲姞鏂版爣绛?': '添加新标签',
    '杈撳叆鏍囩鍚嶇О': '输入标签名称',
    '娣诲姞': '添加',
    '鍙栨秷': '取消',
    '淇濆瓨': '保存',
    '琛ㄨ褰曠紪杈戞ā鎬佹': '表记录编辑模态框',
    '缂栬緫璁板綍': '编辑记录',
    'API娴嬭瘯妯℃€佹': 'API测试模态框',
    '娴嬭瘯API鎺ュ彛': '测试API接口',
    '璇锋眰淇℃伅': '请求信息',
    '鏂规硶': '方法',
    '绔偣': '端点',
    '璇锋眰浣?(JSON)': '请求体(JSON)',
    '鍝嶅簲缁撴灉': '响应结果',
    '鍙戦€佽姹?': '发送请求',
    '閲嶇疆': '重置',
    '鍏抽棴': '关闭',
    '鍙抽敭鑿滃崟': '右键菜单',
    '鍦ㄦ柊鏍囩椤典腑鎵撳紑': '在新标签页中打开',
    '澶嶅埗閾炬帴': '复制链接',
    '绠＄悊鏍囩': '管理标签',
    '鍒犻櫎璐︽埛': '删除账户',
}


def fix_file(filepath):
    """修复单个文件的编码"""
    try:
        with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
            content = f.read()
        
        # 替换所有乱码
        for garbled, correct in replacements.items():
            content = content.replace(garbled, correct)
        
        # 写回文件
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(content)
        
        print(f"✅ 已修复: {filepath}")
        return True
    except Exception as e:
        print(f"❌ 修复失败 {filepath}: {e}")
        return False


def main():
    """主函数"""
    files_to_fix = [
        'static/index.html',
        'static/css/style.css',
        'static/js/app.js',
    ]
    
    print("=" * 60)
    print("开始修复中文乱码...")
    print("=" * 60)
    
    success_count = 0
    for filepath in files_to_fix:
        if os.path.exists(filepath):
            if fix_file(filepath):
                success_count += 1
        else:
            print(f"⚠️  文件不存在: {filepath}")
    
    print("=" * 60)
    print(f"修复完成！成功修复 {success_count}/{len(files_to_fix)} 个文件")
    print("=" * 60)


if __name__ == "__main__":
    main()

