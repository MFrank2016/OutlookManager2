<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Outlooké‚®ä»¶ç®¡ç†ç³»ç»Ÿ</title>
    <!-- CSS æ¨¡å— -->
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/layout.css">
    <link rel="stylesheet" href="/static/css/components.css">
    <link rel="stylesheet" href="/static/css/search-filter.css">
    <link rel="stylesheet" href="/static/css/tags.css">
    <link rel="stylesheet" href="/static/css/forms.css">
    <link rel="stylesheet" href="/static/css/accounts.css">
    <link rel="stylesheet" href="/static/css/emails.css">
    <link rel="stylesheet" href="/static/css/admin.css">
    <link rel="stylesheet" href="/static/css/apidocs.css">
    <link rel="stylesheet" href="/static/css/context-menu.css">
    <link rel="stylesheet" href="/static/css/responsive.css">
</head>
<body>
    <div class="app-container">
        <!-- å·¦ä¾§èœå• -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div>
                    <h1>ğŸ“§ é‚®ä»¶ç®¡ç†</h1>
                    <p>Outlooké‚®ä»¶ç®¡ç†ç³»ç»Ÿ</p>
                </div>
                <button class="sidebar-toggle" onclick="toggleSidebar()" title="æŠ˜å /å±•å¼€ä¾§è¾¹æ ">
                    â—€
                </button>
            </div>
            <nav class="sidebar-nav">
                <button class="nav-item active" onclick="showPage('accounts', this)" data-tooltip="é‚®ç®±è´¦æˆ·">
                    <span class="icon">ğŸ‘¥</span>
                    <span class="nav-text">é‚®ç®±è´¦æˆ·</span>
                </button>
                <button class="nav-item" onclick="showPage('addAccount', this)" data-tooltip="æ·»åŠ è´¦æˆ·">
                    <span class="icon">â•</span>
                    <span class="nav-text">æ·»åŠ è´¦æˆ·</span>
                </button>
                <button class="nav-item" onclick="showPage('batchAdd', this)" data-tooltip="æ‰¹é‡æ·»åŠ ">
                    <span class="icon">ğŸ“¦</span>
                    <span class="nav-text">æ‰¹é‡æ·»åŠ </span>
                </button>
                <button class="nav-item" onclick="showPage('adminPanel', this)" data-tooltip="ç®¡ç†é¢æ¿">
                    <span class="icon">âš™ï¸</span>
                    <span class="nav-text">ç®¡ç†é¢æ¿</span>
                </button>
                <button class="nav-item" onclick="showPage('apiDocs', this)" data-tooltip="APIç®¡ç†">
                    <span class="icon">ğŸ“–</span>
                    <span class="nav-text">APIç®¡ç†</span>
                </button>
                <button class="nav-item" onclick="showPage('emails', this)" oncontextmenu="showEmailsContextMenu(event)" id="emailsNav" style="display: none;" data-tooltip="é‚®ä»¶åˆ—è¡¨">
                    <span class="icon">ğŸ“§</span>
                    <span class="nav-text">é‚®ä»¶åˆ—è¡¨</span>
                </button>
            </nav>
        </div>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <div class="main-body">
                <!-- é‚®ç®±è´¦æˆ·åˆ—è¡¨é¡µé¢ -->
                <div id="accountsPage" class="page">
                    <div class="card">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <h3 class="font-semibold">é‚®ç®±è´¦æˆ·ç®¡ç†</h3>
                                <p class="text-sm" style="color: #64748b;">ç®¡ç†æ‰€æœ‰å·²æ·»åŠ çš„é‚®ç®±è´¦æˆ·</p>
                            </div>
                            <div class="flex gap-2">
                                <button class="btn btn-primary btn-sm" onclick="showPage('addAccount')">
                                    <span>â•</span>
                                    æ·»åŠ è´¦æˆ·
                                </button>
                                <button class="btn btn-secondary btn-sm" onclick="showPage('batchAdd')">
                                    <span>ğŸ“¦</span>
                                    æ‰¹é‡æ·»åŠ 
                                </button>
                                <button class="btn btn-secondary btn-sm" onclick="loadAccountsSmart(true)">
                                    <span>ğŸ”„</span>
                                    åˆ·æ–°åˆ—è¡¨
                                </button>
                                <button class="btn btn-primary btn-sm" onclick="showBatchRefreshDialog()">
                                    <span>ğŸ”„</span>
                                    æ‰¹é‡åˆ·æ–°Token
                                </button>
                            </div>
                        </div>
                        
                        <!-- æœç´¢å’Œè¿‡æ»¤åŒºåŸŸ -->
                        <div class="search-container">
                            <div class="flex gap-3 mb-4">
                                <div class="flex-1">
                                    <input type="text" id="emailSearch" class="form-control" placeholder="æŒ‰é‚®ç®±è´¦å·æœç´¢..." onkeypress="handleSearchKeyPress(event)">
                                </div>
                                <div class="flex-1">
                                    <input type="text" id="tagSearch" class="form-control" placeholder="æŒ‰æ ‡ç­¾æœç´¢..." onkeypress="handleSearchKeyPress(event)">
                                </div>
                                <div class="flex-1">
                                    <select id="refreshStatusFilter" class="form-control" onchange="handleRefreshStatusChange()">
                                        <option value="all">å…¨éƒ¨çŠ¶æ€</option>
                                        <option value="never_refreshed">ä»æœªåˆ·æ–°</option>
                                        <option value="failed">åˆ·æ–°å¤±è´¥</option>
                                        <option value="success">åˆ·æ–°æˆåŠŸ</option>
                                        <option value="custom">æŒ‡å®šåˆ·æ–°æ¡ä»¶</option>
                                    </select>
                                </div>
                                <button class="btn btn-primary" onclick="searchAccounts()">
                                    <span>ğŸ”</span>
                                    æœç´¢
                                </button>
                                <button class="btn btn-secondary" onclick="clearSearch()">
                                    <span>ğŸ—‘ï¸</span>
                                    æ¸…é™¤
                                </button>
                            </div>
                            
                            <!-- è‡ªå®šä¹‰æ—¥æœŸèŒƒå›´é€‰æ‹© -->
                            <div id="customDateRangeContainer" class="flex gap-3 mb-4" style="display: none;">
                                <div class="flex-1">
                                    <label class="text-sm text-gray-600 mb-1" style="display: block;">åˆ·æ–°èµ·å§‹æ—¶é—´</label>
                                    <input type="datetime-local" id="refreshStartDate" class="form-control">
                                </div>
                                <div class="flex-1">
                                    <label class="text-sm text-gray-600 mb-1" style="display: block;">åˆ·æ–°æˆªæ­¢æ—¶é—´</label>
                                    <input type="datetime-local" id="refreshEndDate" class="form-control">
                                </div>
                                <div style="display: flex; align-items: flex-end;">
                                    <button class="btn btn-info" onclick="applyCustomDateFilter()">
                                        <span>âœ“</span>
                                        åº”ç”¨ç­›é€‰
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                        <div id="accountsStats" class="mb-4" style="display: none;">
                            <div class="flex gap-4 text-sm">
                                <span>æ€»æ•°ï¼š<strong id="totalAccounts">0</strong></span>
                                <span>å½“å‰é¡µï¼š<strong id="currentPage">1</strong></span>
                                <span>æ¯é¡µï¼š<strong id="pageSize">10</strong></span>
                            </div>
                        </div>

                        <div id="accountsList">
                            <div class="loading">
                                <div class="loading-spinner"></div>
                                æ­£åœ¨åŠ è½½è´¦æˆ·åˆ—è¡¨...
                            </div>
                        </div>
                        
                        <!-- åˆ†é¡µæ§ä»¶ -->
                        <div id="accountsPagination" class="pagination" style="display: none;">
                            <button class="btn btn-sm" id="prevPageBtn" onclick="changePage('prev')" disabled>
                                <span>â†</span>
                                ä¸Šä¸€é¡µ
                            </button>
                            <div id="pageNumbers" class="flex gap-1"></div>
                            <button class="btn btn-sm" id="nextPageBtn" onclick="changePage('next')">
                                ä¸‹ä¸€é¡µ
                                <span>â†’</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- æ·»åŠ å•ä¸ªè´¦æˆ·é¡µé¢ -->
                <div id="addAccountPage" class="page hidden">
                    <div class="card">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="font-semibold">æ·»åŠ é‚®ç®±è´¦æˆ·</h3>
                                <p class="text-sm" style="color: #64748b;">æ·»åŠ å•ä¸ªOutlooké‚®ç®±è´¦æˆ·åˆ°ç³»ç»Ÿ</p>
                            </div>
                            <button class="btn btn-secondary btn-sm" onclick="showPage('accounts')">
                                <span>â†</span>
                                è¿”å›åˆ—è¡¨
                            </button>
                        </div>

                        <div style="max-width: 600px;">
                            <div class="form-group">
                                <label class="form-label">é‚®ç®±åœ°å€ *</label>
                                <input type="email" id="email" class="form-input" placeholder="example@outlook.com" required>
                                <p class="text-xs" style="color: #64748b; margin-top: 4px;">è¯·è¾“å…¥æœ‰æ•ˆçš„Outlooké‚®ç®±åœ°å€</p>
                            </div>

                            <div class="form-group">
                                <label class="form-label">åˆ·æ–°ä»¤ç‰Œ (Refresh Token) *</label>
                                <textarea id="refreshToken" class="form-input form-textarea" rows="4" placeholder="ä»Azureåº”ç”¨è·å–çš„refresh_token" required></textarea>
                                <p class="text-xs" style="color: #64748b; margin-top: 4px;">
                                    ä»Azureåº”ç”¨ç¨‹åºæ³¨å†Œä¸­è·å–çš„åˆ·æ–°ä»¤ç‰Œï¼Œç”¨äºOAuth2è®¤è¯
                                </p>
                            </div>

                            <div class="form-group">
                                <label class="form-label">å®¢æˆ·ç«¯ID (Client ID) *</label>
                                <input type="text" id="clientId" class="form-input" placeholder="Azureåº”ç”¨çš„client_id" required>
                                <p class="text-xs" style="color: #64748b; margin-top: 4px;">
                                    Azureåº”ç”¨ç¨‹åºçš„å®¢æˆ·ç«¯æ ‡è¯†ç¬¦
                                </p>
                            </div>

                            <div class="form-group">
                                <div style="background: #f8fafc; padding: 16px; border-radius: 8px; border: 1px solid #e2e8f0;">
                                    <h4 style="margin: 0 0 8px 0; font-size: 0.875rem; font-weight: 600; color: #374151;">ğŸ“‹ è·å–æ­¥éª¤ï¼š</h4>
                                    <ol style="margin: 0; padding-left: 20px; font-size: 0.75rem; color: #6b7280; line-height: 1.5;">
                                        <li>è®¿é—® <a href="https://portal.azure.com" target="_blank" style="color: #3b82f6;">Azure Portal</a></li>
                                        <li>æ³¨å†Œåº”ç”¨ç¨‹åºå¹¶é…ç½®æƒé™</li>
                                        <li>è·å–Client IDå’ŒRefresh Token</li>
                                        <li>ç¡®ä¿åº”ç”¨æœ‰é‚®ä»¶è¯»å–æƒé™</li>
                                    </ol>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="accountTags">æ ‡ç­¾ (å¯é€‰ï¼Œç”¨é€—å·åˆ†éš”)</label>
                                <input type="text" id="accountTags" class="form-control" placeholder="å·¥ä½œ,ä¸ªäºº,é‡è¦">
                            </div>

                            <div class="flex gap-3">
                                <button class="btn btn-primary" onclick="addAccount()" id="addAccountBtn">
                                    <span>â•</span>
                                    æ·»åŠ è´¦æˆ·
                                </button>
                                <button class="btn btn-secondary" onclick="clearAddAccountForm()">
                                    <span>ğŸ—‘ï¸</span>
                                    æ¸…ç©ºè¡¨å•
                                </button>
                                <button class="btn btn-secondary" onclick="testAccountConnection()" id="testBtn">
                                    <span>ğŸ”</span>
                                    æµ‹è¯•è¿æ¥
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ‰¹é‡æ·»åŠ è´¦æˆ·é¡µé¢ -->
                <div id="batchAddPage" class="page hidden">
                    <div class="card">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="font-semibold">æ‰¹é‡æ·»åŠ é‚®ç®±è´¦æˆ·</h3>
                                <p class="text-sm" style="color: #64748b;">ä¸€æ¬¡æ€§æ·»åŠ å¤šä¸ªé‚®ç®±è´¦æˆ·åˆ°ç³»ç»Ÿ</p>
                            </div>
                            <button class="btn btn-secondary btn-sm" onclick="showPage('accounts')">
                                <span>â†</span>
                                è¿”å›åˆ—è¡¨
                            </button>
                        </div>

                        <div style="max-width: 800px;">
                            <div class="form-group">
                                <label class="form-label">æ‰¹é‡è´¦æˆ·ä¿¡æ¯</label>
                                <p class="text-sm" style="color: #64748b; margin-bottom: 8px;">
                                    æ¯è¡Œæ ¼å¼ï¼š<code>é‚®ç®±----å¯†ç ----åˆ·æ–°ä»¤ç‰Œ----å®¢æˆ·ç«¯ID</code>
                                </p>
                                <p class="text-sm" style="color: #64748b; margin-bottom: 12px;">
                                    ğŸ“§ æ¨èè´­ä¹°åœ°å€ï¼ˆéå¹¿å‘Šï¼Œåªæ˜¯æ¨èï¼‰ï¼š
                                    <a target="_blank" href="http://wmemail.com" style="color: #3b82f6; margin: 0 8px;">wmemail.com</a>
                                </p>
                                <textarea id="batchAccounts" class="form-input form-textarea" rows="12" placeholder="example1@outlook.com----password1----refresh_token1----client_id1
example2@outlook.com----password2----refresh_token2----client_id2
example3@outlook.com----password3----refresh_token3----client_id3"></textarea>
                                <p class="text-xs" style="color: #64748b; margin-top: 8px;">
                                    ğŸ’¡ æç¤ºï¼šæ¯è¡Œä¸€ä¸ªè´¦æˆ·ï¼Œä½¿ç”¨å››ä¸ªè¿å­—ç¬¦(----)åˆ†éš”å­—æ®µ
                                </p>
                            </div>

                            <div class="form-group">
                                <div style="background: #fef3c7; padding: 16px; border-radius: 8px; border: 1px solid #fbbf24;">
                                    <h4 style="margin: 0 0 8px 0; font-size: 0.875rem; font-weight: 600; color: #92400e;">âš ï¸ æ³¨æ„äº‹é¡¹ï¼š</h4>
                                    <ul style="margin: 0; padding-left: 20px; font-size: 0.75rem; color: #92400e; line-height: 1.5;">
                                        <li>ç¡®ä¿æ‰€æœ‰è´¦æˆ·ä¿¡æ¯æ ¼å¼æ­£ç¡®</li>
                                        <li>å»ºè®®å…ˆæµ‹è¯•å°‘é‡è´¦æˆ·å†æ‰¹é‡æ·»åŠ </li>
                                        <li>æ·»åŠ è¿‡ç¨‹ä¸­è¯·å‹¿å…³é—­é¡µé¢</li>
                                        <li>å¤±è´¥çš„è´¦æˆ·ä¼šåœ¨ç»“æœä¸­æ˜¾ç¤º</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="flex gap-3">
                                <button class="btn btn-primary" onclick="batchAddAccounts()" id="batchAddBtn">
                                    <span>ğŸ“¦</span>
                                    å¼€å§‹æ‰¹é‡æ·»åŠ 
                                </button>
                                <button class="btn btn-secondary" onclick="clearBatchForm()">
                                    <span>ğŸ—‘ï¸</span>
                                    æ¸…ç©ºè¡¨å•
                                </button>
                                <button class="btn btn-secondary" onclick="validateBatchFormat()">
                                    <span>âœ…</span>
                                    éªŒè¯æ ¼å¼
                                </button>
                                <button class="btn btn-secondary" onclick="loadSampleData()">
                                    <span>ğŸ“</span>
                                    åŠ è½½ç¤ºä¾‹
                                </button>
                            </div>

                            <!-- æ‰¹é‡æ·»åŠ è¿›åº¦ -->
                            <div id="batchProgress" class="hidden" style="margin-top: 24px;">
                                <h4 style="margin-bottom: 12px; font-size: 0.875rem; font-weight: 600;">æ·»åŠ è¿›åº¦ï¼š</h4>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="batchProgressFill"></div>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: #64748b; margin-top: 8px;">
                                    <span id="batchProgressText">å‡†å¤‡ä¸­...</span>
                                    <span id="batchProgressCount">0 / 0</span>
                                </div>
                            </div>

                            <!-- æ‰¹é‡æ·»åŠ ç»“æœ -->
                            <div id="batchResults" class="hidden" style="margin-top: 24px;">
                                <h4 style="margin-bottom: 12px; font-size: 0.875rem; font-weight: 600;">æ·»åŠ ç»“æœï¼š</h4>
                                <div id="batchResultsList"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç®¡ç†é¢æ¿é¡µé¢ -->
                <div id="adminPanelPage" class="page hidden">
                    <div class="card">
                        <h3 class="font-semibold mb-4">âš™ï¸ ç³»ç»Ÿç®¡ç†é¢æ¿</h3>
                        <p class="text-sm mb-6" style="color: #64748b;">ç®¡ç†æ•°æ®åº“è¡¨å’Œç³»ç»Ÿé…ç½®</p>
                        
                        <!-- æ ‡ç­¾é¡µ -->
                        <div class="tabs mb-4">
                            <button class="tab active" onclick="switchAdminTab('tables', this)">æ•°æ®è¡¨ç®¡ç†</button>
                            <button class="tab" onclick="switchAdminTab('config', this)">ç³»ç»Ÿé…ç½®</button>
                        </div>

                        <!-- æ•°æ®è¡¨ç®¡ç† -->
                        <div id="tablesPanel" class="admin-panel">
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">æ•°æ®åº“è¡¨åˆ—è¡¨</h4>
                                <div id="tablesList" class="tables-list loading">æ­£åœ¨åŠ è½½è¡¨åˆ—è¡¨...</div>
                            </div>
                            
                            <div id="tableDataPanel" class="hidden">
                                <div class="flex items-center justify-between mb-4">
                                    <h4 class="font-semibold">è¡¨æ•°æ®: <span id="currentTableName"></span></h4>
                                    <div>
                                        <button class="btn btn-primary btn-sm" onclick="openAddRecordModal()">
                                            <span>â•</span> æ·»åŠ è®°å½•
                                        </button>
                                        <button class="btn btn-secondary btn-sm" onclick="refreshTableData()">
                                            <span>ğŸ”„</span> åˆ·æ–°
                                        </button>
                                        <button class="btn btn-secondary btn-sm" onclick="backToTablesList()">
                                            <span>â†</span> è¿”å›
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <input type="text" id="tableSearch" class="form-control" placeholder="æœç´¢è¡¨æ•°æ®..." 
                                           oninput="searchTableData()" style="max-width: 300px;">
                                </div>
                                
                                <div id="tableDataContent" class="loading">æ­£åœ¨åŠ è½½æ•°æ®...</div>
                                
                                <div id="tablePagination" class="pagination hidden"></div>
                            </div>
                        </div>

                        <!-- ç³»ç»Ÿé…ç½®ç®¡ç† -->
                        <div id="configPanel" class="admin-panel hidden">
                            <div class="mb-4">
                                <h4 class="font-semibold mb-2">ç³»ç»Ÿé…ç½®é¡¹</h4>
                                <p class="text-sm" style="color: #64748b;">é…ç½®IMAPæœåŠ¡å™¨ã€è¿æ¥æ± ã€ç¼“å­˜ç­‰ç³»ç»Ÿå‚æ•°</p>
                            </div>
                            <div id="configsList" class="configs-list loading">æ­£åœ¨åŠ è½½é…ç½®...</div>
                        </div>
                    </div>
                </div>

                <!-- APIæ–‡æ¡£é¡µé¢ -->
                <div id="apiDocsPage" class="page hidden">
                    <div class="card">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="font-semibold">APIæ¥å£æ–‡æ¡£</h3>
                                <p class="text-sm" style="color: #64748b;">é‚®ä»¶ç®¡ç†ç³»ç»Ÿçš„RESTful APIæ¥å£è¯´æ˜</p>
                            </div>
                            <div class="flex gap-2">
                                <button class="btn btn-secondary btn-sm" onclick="copyApiBaseUrl()">
                                    <span>ğŸ“‹</span>
                                    å¤åˆ¶Base URL
                                </button>
                                <button class="btn btn-secondary btn-sm" onclick="downloadApiDocs()">
                                    <span>ğŸ“¥</span>
                                    ä¸‹è½½æ–‡æ¡£
                                </button>
                            </div>
                        </div>

                        <div class="api-docs">
                            <!-- APIåŸºç¡€ä¿¡æ¯ -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div>
                                        <h3 style="margin: 0; color: #1f2937;">ğŸ“¡ APIåŸºç¡€ä¿¡æ¯</h3>
                                    </div>
                                </div>
                                <div class="api-body">
                                    <div class="api-section">
                                        <h4>Base URL</h4>
                                        <div class="api-example" id="baseUrlExample">http://localhost:8001</div>
                                    </div>
                                    <div class="api-section">
                                        <h4>è®¤è¯æ–¹å¼</h4>
                                        <p class="api-description">âœ… JWT Tokenè®¤è¯ - æ‰€æœ‰APIéƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦JWT Token</p>
                                        <div class="api-example">Authorization: Bearer &lt;your_jwt_token&gt;</div>
                                        <p class="api-description" style="margin-top: 8px; font-size: 0.75rem;">
                                            ğŸ’¡ é€šè¿‡ <code>POST /auth/login</code> æ¥å£è·å–Tokenï¼ŒTokenæœ‰æ•ˆæœŸä¸º24å°æ—¶ã€‚
                                        </p>
                                    </div>
                                    <div class="api-section">
                                        <h4>å“åº”æ ¼å¼</h4>
                                        <p class="api-description">æ‰€æœ‰æ¥å£è¿”å›JSONæ ¼å¼æ•°æ®ï¼ŒHTTPçŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚ç»“æœã€‚</p>
                                        <ul style="margin: 8px 0; padding-left: 20px; font-size: 0.875rem; color: #64748b;">
                                            <li>200: æˆåŠŸ</li>
                                            <li>401: æœªè®¤è¯æˆ–Tokenè¿‡æœŸ</li>
                                            <li>404: èµ„æºä¸å­˜åœ¨</li>
                                            <li>400/422: è¯·æ±‚å‚æ•°é”™è¯¯</li>
                                            <li>500: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯</li>
                                        </ul>
                                    </div>
                                    <div class="api-section">
                                        <h4>ç‰ˆæœ¬ä¿¡æ¯</h4>
                                        <p class="api-description">å½“å‰ç‰ˆæœ¬: <strong>v2.0.0</strong></p>
                                        <p class="api-description" style="font-size: 0.75rem; margin-top: 4px;">
                                            æ–°å¢åŠŸèƒ½ï¼šJWTè®¤è¯ã€æ—¥å¿—ç³»ç»Ÿã€SQLiteå­˜å‚¨ã€ç®¡ç†é¢æ¿
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <!-- è®¤è¯ç›¸å…³API -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div>
                                        <h3 style="margin: 0; color: #1f2937;">ğŸ” è®¤è¯ç®¡ç†</h3>
                                    </div>
                                </div>
                            </div>

            <!-- ç™»å½•æ¥å£ -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method post">POST</span>
                        <span class="api-path">/auth/login</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('login')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">ç®¡ç†å‘˜ç™»å½•ï¼Œè¿”å›JWT Tokenã€‚</p>

                                    <div class="api-section">
                                        <h4>è¯·æ±‚ä½“</h4>
                                        <div class="api-example">{
  "username": "admin",
  "password": "admin123"
}</div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}</div>
                                    </div>
                                </div>
                            </div>

            <!-- è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method get">GET</span>
                        <span class="api-path">/auth/me</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('me')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">è·å–å½“å‰ç™»å½•çš„ç®¡ç†å‘˜ä¿¡æ¯ï¼ˆéœ€è¦JWTè®¤è¯ï¼‰ã€‚</p>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "id": 1,
  "username": "admin",
  "email": null,
  "is_active": true,
  "created_at": "2025-01-01 12:00:00",
  "last_login": "2025-01-15 14:30:00"
}</div>
                                    </div>
                                </div>
                            </div>

            <!-- ä¿®æ”¹å¯†ç  -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method post">POST</span>
                        <span class="api-path">/auth/change-password</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('changePassword')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">ä¿®æ”¹å½“å‰ç®¡ç†å‘˜å¯†ç ï¼ˆéœ€è¦JWTè®¤è¯ï¼‰ã€‚</p>

                                    <div class="api-section">
                                        <h4>è¯·æ±‚ä½“</h4>
                                        <div class="api-example">{
  "old_password": "old_password",
  "new_password": "new_password"
}</div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "message": "å¯†ç ä¿®æ”¹æˆåŠŸ"
}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- è´¦æˆ·ç®¡ç†API -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div>
                                        <h3 style="margin: 0; color: #1f2937;">ğŸ‘¥ è´¦æˆ·ç®¡ç†</h3>
                                    </div>
                                </div>
                            </div>

                            <!-- è·å–é‚®ç®±åˆ—è¡¨æ¥å£ -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div style="display: flex; align-items: center;">
                                        <span class="api-method get">GET</span>
                                        <span class="api-path">/accounts</span>
                                    </div>
                                    <button class="api-try-button" onclick="openApiTest('accounts')">ğŸš€ è¯•ç”¨æ¥å£</button>
                                </div>
                                <div class="api-body">
                                    <p class="api-description">è·å–ç³»ç»Ÿä¸­æ‰€æœ‰å·²æ·»åŠ çš„é‚®ç®±è´¦æˆ·åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œæ¨¡ç³Šæœç´¢ã€‚</p>

                                    <div class="api-section">
                                        <h4>è¯·æ±‚å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">page</span>
                                                <span class="api-param-type">integer</span>
                                                <span class="api-param-desc">é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤: 1</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">page_size</span>
                                                <span class="api-param-type">integer</span>
                                                <span class="api-param-desc">æ¯é¡µæ•°é‡ï¼ŒèŒƒå›´1-100ï¼Œé»˜è®¤: 10</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">email_search</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ç®±è´¦å·æ¨¡ç³Šæœç´¢ï¼Œå¯é€‰</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">tag_search</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">æ ‡ç­¾æ¨¡ç³Šæœç´¢ï¼Œå¯é€‰</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">refresh_status</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">åˆ·æ–°çŠ¶æ€ç­›é€‰ (all, never_refreshed, success, failed, pending)ï¼Œå¯é€‰</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">time_filter</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">æ—¶é—´è¿‡æ»¤å™¨ (today, week, month, custom)ï¼Œå¯é€‰</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">after_date</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">è‡ªå®šä¹‰æ—¥æœŸï¼ˆISOæ ¼å¼ï¼‰ï¼Œä¸time_filter=customé…åˆä½¿ç”¨ï¼Œå¯é€‰</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "total_accounts": 25,
  "page": 1,
  "page_size": 10,
  "total_pages": 3,
  "accounts": [
    {
      "email_id": "example@outlook.com",
      "client_id": "your-client-id",
      "status": "active",
      "tags": ["å·¥ä½œ", "ä¸ªäºº"]
    }
  ]
}</div>
                                    </div>

                                    <div class="api-response" id="accountsResponse">
                                        <h4 style="margin-bottom: 8px; color: #15803d;">å“åº”ç»“æœï¼š</h4>
                                        <pre id="accountsResponseData"></pre>
                                    </div>
                                </div>
                            </div>

                            <!-- å•ä¸ªè´¦æˆ·åˆ·æ–°Tokenæ¥å£ -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div style="display: flex; align-items: center;">
                                        <span class="api-method post">POST</span>
                                        <span class="api-path">/accounts/{email_id}/refresh-token</span>
                                    </div>
                                    <button class="api-try-button" onclick="openApiTest('singleRefreshToken')">ğŸš€ è¯•ç”¨æ¥å£</button>
                                </div>
                                <div class="api-body">
                                    <p class="api-description">æ‰‹åŠ¨åˆ·æ–°æŒ‡å®šè´¦æˆ·çš„OAuth2 Tokenï¼Œç”¨äºéªŒè¯è´¦æˆ·å‡­è¯æˆ–æ›´æ–°è¿‡æœŸçš„Tokenã€‚</p>

                                    <div class="api-section">
                                        <h4>è·¯å¾„å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">email_id</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ç®±åœ°å€ï¼Œéœ€è¦URLç¼–ç </span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>è¯·æ±‚ç¤ºä¾‹</h4>
                                        <div class="api-example">POST /accounts/example%40outlook.com/refresh-token</div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "email_id": "example@outlook.com",
  "message": "Token refreshed successfully at 2024-01-01T12:00:00"
}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- æ‰¹é‡åˆ·æ–°Tokenæ¥å£ -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div style="display: flex; align-items: center;">
                                        <span class="api-method post">POST</span>
                                        <span class="api-path">/accounts/batch-refresh-tokens</span>
                                    </div>
                                    <button class="api-try-button" onclick="openApiTest('batchRefreshTokens')">ğŸš€ è¯•ç”¨æ¥å£</button>
                                </div>
                                <div class="api-body">
                                    <p class="api-description">æ‰¹é‡åˆ·æ–°ç¬¦åˆç­›é€‰æ¡ä»¶çš„è´¦æˆ·Tokenï¼Œæ”¯æŒå¤šç»´åº¦ç­›é€‰ï¼ˆé‚®ç®±ã€æ ‡ç­¾ã€åˆ·æ–°çŠ¶æ€ã€æ—¶é—´èŒƒå›´ï¼‰ã€‚</p>

                                    <div class="api-section">
                                        <h4>æŸ¥è¯¢å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">email_search</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ç®±è´¦å·æ¨¡ç³Šæœç´¢ï¼Œå¯é€‰</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">tag_search</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">æ ‡ç­¾æ¨¡ç³Šæœç´¢ï¼Œå¯é€‰</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">refresh_status</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">åˆ·æ–°çŠ¶æ€ç­›é€‰ (all, never_refreshed, success, failed, pending)ï¼Œå¯é€‰</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">time_filter</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">æ—¶é—´è¿‡æ»¤å™¨ (today, week, month, custom)ï¼Œå¯é€‰</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">after_date</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">è‡ªå®šä¹‰æ—¥æœŸï¼ˆISOæ ¼å¼ï¼‰ï¼Œä¸time_filter=customé…åˆä½¿ç”¨ï¼Œå¯é€‰</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>è¯·æ±‚ç¤ºä¾‹</h4>
                                        <div class="api-example">POST /accounts/batch-refresh-tokens?refresh_status=failed</div>
                                        <div class="api-example">POST /accounts/batch-refresh-tokens?tag_search=å·¥ä½œ&refresh_status=never_refreshed</div>
                                        <div class="api-example">POST /accounts/batch-refresh-tokens?time_filter=week</div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "total_processed": 10,
  "success_count": 8,
  "failed_count": 2,
  "details": [
    {
      "email": "user1@outlook.com",
      "status": "success",
      "message": "Token refreshed successfully"
    },
    {
      "email": "user2@outlook.com",
      "status": "failed",
      "message": "HTTP 400 error refreshing token"
    }
  ]
}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- è·å–é‚®ä»¶åˆ—è¡¨æ¥å£ -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div style="display: flex; align-items: center;">
                                        <span class="api-method get">GET</span>
                                        <span class="api-path">/emails/{email_id}</span>
                                    </div>
                                    <button class="api-try-button" onclick="openApiTest('emails')">ğŸš€ è¯•ç”¨æ¥å£</button>
                                </div>
                                <div class="api-body">
                                    <p class="api-description">è·å–æŒ‡å®šé‚®ç®±çš„é‚®ä»¶åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œè¿‡æ»¤ã€‚</p>

                                    <div class="api-section">
                                        <h4>è·¯å¾„å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">email_id</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ç®±åœ°å€ï¼Œéœ€è¦URLç¼–ç </span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>æŸ¥è¯¢å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">folder</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ä»¶æ–‡ä»¶å¤¹ (all, inbox, junk)ï¼Œé»˜è®¤: all</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">page</span>
                                                <span class="api-param-type">integer</span>
                                                <span class="api-param-desc">é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤: 1</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">page_size</span>
                                                <span class="api-param-type">integer</span>
                                                <span class="api-param-desc">æ¯é¡µæ•°é‡ï¼ŒèŒƒå›´1-500ï¼Œé»˜è®¤: 100</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">refresh</span>
                                                <span class="api-param-type">boolean</span>
                                                <span class="api-param-desc">æ˜¯å¦å¼ºåˆ¶åˆ·æ–°ç¼“å­˜ï¼Œé»˜è®¤: false</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>è¯·æ±‚ç¤ºä¾‹</h4>
                                        <div class="api-example">GET /emails/example%40outlook.com?folder=inbox&page=1&page_size=20&refresh=true</div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "email_id": "example@outlook.com",
  "folder_view": "inbox",
  "page": 1,
  "page_size": 20,
  "total_emails": 150,
  "emails": [
    {
      "message_id": "INBOX-1",
      "folder": "INBOX",
      "subject": "é‚®ä»¶ä¸»é¢˜",
      "from_email": "sender@example.com",
      "date": "2024-01-01T12:00:00Z",
      "is_read": false,
      "has_attachments": true,
      "sender_initial": "S"
    }
  ]
}</div>
                                    </div>

                                    <div class="api-response" id="emailsResponse">
                                        <h4 style="margin-bottom: 8px; color: #15803d;">å“åº”ç»“æœï¼š</h4>
                                        <pre id="emailsResponseData"></pre>
                                    </div>
                                </div>
                            </div>

                            <!-- è·å–é‚®ä»¶è¯¦æƒ…æ¥å£ -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div style="display: flex; align-items: center;">
                                        <span class="api-method get">GET</span>
                                        <span class="api-path">/emails/{email_id}/{message_id}</span>
                                    </div>
                                    <button class="api-try-button" onclick="openApiTest('emailDetail')">ğŸš€ è¯•ç”¨æ¥å£</button>
                                </div>
                                <div class="api-body">
                                    <p class="api-description">è·å–æŒ‡å®šé‚®ä»¶çš„è¯¦ç»†å†…å®¹ï¼ŒåŒ…æ‹¬é‚®ä»¶æ­£æ–‡ã€‚</p>

                                    <div class="api-section">
                                        <h4>è·¯å¾„å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">email_id</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ç®±åœ°å€ï¼Œéœ€è¦URLç¼–ç </span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">message_id</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ä»¶IDï¼Œæ ¼å¼: {folder}-{id}</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>è¯·æ±‚ç¤ºä¾‹</h4>
                                        <div class="api-example">GET /emails/example%40outlook.com/INBOX-1</div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "message_id": "INBOX-1",
  "subject": "é‚®ä»¶ä¸»é¢˜",
  "from_email": "sender@example.com",
  "to_email": "example@outlook.com",
  "date": "2024-01-01T12:00:00Z",
  "body_plain": "çº¯æ–‡æœ¬é‚®ä»¶å†…å®¹",
  "body_html": "&lt;html&gt;&lt;body&gt;HTMLé‚®ä»¶å†…å®¹&lt;/body&gt;&lt;/html&gt;"
}</div>
                                    </div>

                                    <div class="api-response" id="emailDetailResponse">
                                        <h4 style="margin-bottom: 8px; color: #15803d;">å“åº”ç»“æœï¼š</h4>
                                        <pre id="emailDetailResponseData"></pre>
                                    </div>
                                </div>
                            </div>

                            <!-- è·å–åŒæ è§†å›¾é‚®ä»¶ -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div style="display: flex; align-items: center;">
                                        <span class="api-method get">GET</span>
                                        <span class="api-path">/emails/{email_id}/dual-view</span>
                                    </div>
                                    <button class="api-try-button" onclick="openApiTest('dualView')">ğŸš€ è¯•ç”¨æ¥å£</button>
                                </div>
                                <div class="api-body">
                                    <p class="api-description">è·å–åŒæ è§†å›¾é‚®ä»¶ï¼ˆåŒæ—¶è¿”å›æ”¶ä»¶ç®±å’Œåƒåœ¾ç®±é‚®ä»¶ï¼‰ã€‚</p>

                                    <div class="api-section">
                                        <h4>è·¯å¾„å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">email_id</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ç®±åœ°å€ï¼Œéœ€è¦URLç¼–ç </span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>æŸ¥è¯¢å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">inbox_page</span>
                                                <span class="api-param-type">integer</span>
                                                <span class="api-param-desc">æ”¶ä»¶ç®±é¡µç ï¼Œé»˜è®¤: 1</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">junk_page</span>
                                                <span class="api-param-type">integer</span>
                                                <span class="api-param-desc">åƒåœ¾ç®±é¡µç ï¼Œé»˜è®¤: 1</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">page_size</span>
                                                <span class="api-param-type">integer</span>
                                                <span class="api-param-desc">æ¯é¡µæ•°é‡ï¼Œé»˜è®¤: 20</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "email_id": "example@outlook.com",
  "inbox_emails": [...],
  "junk_emails": [...],
  "inbox_total": 100,
  "junk_total": 20
}</div>
                                    </div>
                                </div>
                            </div>

            <!-- æ·»åŠ è´¦æˆ· -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method post">POST</span>
                        <span class="api-path">/accounts</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('addAccount')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">æ·»åŠ æ–°çš„é‚®ç®±è´¦æˆ·ã€‚</p>

                                    <div class="api-section">
                                        <h4>è¯·æ±‚ä½“</h4>
                                        <div class="api-example">{
  "email_id": "example@outlook.com",
  "refresh_token": "your_refresh_token",
  "client_id": "your_client_id",
  "tags": ["å·¥ä½œ", "ä¸ªäºº"]
}</div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "email_id": "example@outlook.com",
  "client_id": "your_client_id",
  "status": "pending",
  "tags": ["å·¥ä½œ", "ä¸ªäºº"],
  "message": "è´¦æˆ·æ·»åŠ æˆåŠŸ"
}</div>
                                    </div>
                                </div>
                            </div>

            <!-- åˆ é™¤è´¦æˆ· -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method delete">DELETE</span>
                        <span class="api-path">/accounts/{email_id}</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('deleteAccount')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">åˆ é™¤æŒ‡å®šçš„é‚®ç®±è´¦æˆ·ã€‚</p>

                                    <div class="api-section">
                                        <h4>è·¯å¾„å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">email_id</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ç®±åœ°å€ï¼Œéœ€è¦URLç¼–ç </span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "email_id": "example@outlook.com",
  "message": "è´¦æˆ·åˆ é™¤æˆåŠŸ"
}</div>
                                    </div>
                                </div>
                            </div>

            <!-- æ›´æ–°è´¦æˆ·æ ‡ç­¾ -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method put">PUT</span>
                        <span class="api-path">/accounts/{email_id}/tags</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('updateTags')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                <div class="api-body">
                    <p class="api-description">æ›´æ–°æŒ‡å®šè´¦æˆ·çš„æ ‡ç­¾åˆ—è¡¨ã€‚</p>

                    <div class="api-section">
                        <h4>è·¯å¾„å‚æ•°</h4>
                        <div class="api-params">
                            <div class="api-param">
                                <span class="api-param-name">email_id</span>
                                <span class="api-param-type">string</span>
                                <span class="api-param-desc">é‚®ç®±åœ°å€ï¼Œéœ€è¦URLç¼–ç </span>
                            </div>
                        </div>
                    </div>

                    <div class="api-section">
                        <h4>è¯·æ±‚ä½“</h4>
                        <div class="api-example">{
  "tags": ["å·¥ä½œ", "ä¸ªäºº", "é‡è¦"]
}</div>
                    </div>

                    <div class="api-section">
                        <h4>è¯·æ±‚ç¤ºä¾‹</h4>
                        <div class="api-example">PUT /accounts/example%40outlook.com/tags</div>
                    </div>

                    <div class="api-section">
                        <h4>å“åº”ç¤ºä¾‹</h4>
                        <div class="api-example">{
  "email_id": "example@outlook.com",
  "message": "Account tags updated successfully."
}</div>
                    </div>
                </div>
            </div>

            <!-- æ·»åŠ è´¦æˆ·æ ‡ç­¾ -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method post">POST</span>
                        <span class="api-path">/accounts/{email_id}/tags/add</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('addTag')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                <div class="api-body">
                    <p class="api-description">ä¸ºæŒ‡å®šè´¦æˆ·æ·»åŠ å•ä¸ªæ ‡ç­¾ï¼ˆå¦‚æœæ ‡ç­¾å·²å­˜åœ¨åˆ™ä¸å¤„ç†ï¼Œå¹‚ç­‰æ“ä½œï¼‰ã€‚</p>

                    <div class="api-section">
                        <h4>è·¯å¾„å‚æ•°</h4>
                        <div class="api-params">
                            <div class="api-param">
                                <span class="api-param-name">email_id</span>
                                <span class="api-param-type">string</span>
                                <span class="api-param-desc">é‚®ç®±åœ°å€ï¼Œéœ€è¦URLç¼–ç </span>
                            </div>
                        </div>
                    </div>

                    <div class="api-section">
                        <h4>è¯·æ±‚ä½“</h4>
                        <div class="api-example">{
  "tag": "VIP"
}</div>
                    </div>

                    <div class="api-section">
                        <h4>è¯·æ±‚ç¤ºä¾‹</h4>
                        <div class="api-example">POST /accounts/example%40outlook.com/tags/add
Content-Type: application/json

{
  "tag": "VIP"
}</div>
                    </div>

                    <div class="api-section">
                        <h4>å“åº”ç¤ºä¾‹</h4>
                        <div class="api-example">{
  "email_id": "example@outlook.com",
  "message": "Tag 'VIP' added successfully."
}</div>
                    </div>

                    <div class="api-section">
                        <h4>ç‰¹æ€§è¯´æ˜</h4>
                        <ul style="margin: 0; padding-left: 20px; color: #6b7280;">
                            <li>å¹‚ç­‰æ“ä½œï¼šé‡å¤æ·»åŠ ç›¸åŒæ ‡ç­¾ä¸ä¼šæŠ¥é”™</li>
                            <li>æ ‡ç­¾æ·»åŠ åˆ°ç°æœ‰æ ‡ç­¾åˆ—è¡¨æœ«å°¾ï¼Œä¸ä¼šè¦†ç›–ç°æœ‰æ ‡ç­¾</li>
                            <li>è´¦æˆ·ä¸å­˜åœ¨æ—¶è¿”å›404é”™è¯¯</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- éšæœºè·å–é‚®ç®± -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method get">GET</span>
                        <span class="api-path">/accounts/random</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('randomAccounts')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                <div class="api-body">
                    <p class="api-description">éšæœºè·å–é‚®ç®±è´¦æˆ·åˆ—è¡¨ï¼Œæ”¯æŒæ ‡ç­¾ç­›é€‰å’Œåˆ†é¡µã€‚æ¯æ¬¡è¯·æ±‚è¿”å›çš„é¡ºåºéƒ½æ˜¯éšæœºçš„ã€‚</p>

                    <div class="api-section">
                        <h4>è¯·æ±‚å‚æ•°</h4>
                        <div class="api-params">
                            <div class="api-param">
                                <span class="api-param-name">include_tags</span>
                                <span class="api-param-type">string</span>
                                <span class="api-param-desc">å¿…é¡»åŒ…å«çš„æ ‡ç­¾ï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼Œå¯é€‰</span>
                            </div>
                            <div class="api-param">
                                <span class="api-param-name">exclude_tags</span>
                                <span class="api-param-type">string</span>
                                <span class="api-param-desc">å¿…é¡»ä¸åŒ…å«çš„æ ‡ç­¾ï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼Œå¯é€‰</span>
                            </div>
                            <div class="api-param">
                                <span class="api-param-name">page</span>
                                <span class="api-param-type">integer</span>
                                <span class="api-param-desc">é¡µç ï¼Œä»1å¼€å§‹ï¼Œé»˜è®¤: 1</span>
                            </div>
                            <div class="api-param">
                                <span class="api-param-name">page_size</span>
                                <span class="api-param-type">integer</span>
                                <span class="api-param-desc">æ¯é¡µæ•°é‡ï¼ŒèŒƒå›´1-100ï¼Œé»˜è®¤: 10</span>
                            </div>
                        </div>
                    </div>

                    <div class="api-section">
                        <h4>è¯·æ±‚ç¤ºä¾‹</h4>
                        <div class="api-example">GET /accounts/random?exclude_tags=ç¦ç”¨&page_size=5</div>
                    </div>

                    <div class="api-section">
                        <h4>å“åº”ç¤ºä¾‹</h4>
                        <div class="api-example">{
  "total_accounts": 20,
  "page": 1,
  "page_size": 5,
  "total_pages": 4,
  "accounts": [
    {
      "email_id": "user1@outlook.com",
      "client_id": "client-id",
      "status": "active",
      "tags": ["å·¥ä½œ", "é‡è¦"],
      "last_refresh_time": "2025-10-30T12:00:00",
      "next_refresh_time": "2025-11-02T12:00:00",
      "refresh_status": "success"
    }
  ]
}</div>
                    </div>

                    <div class="api-section">
                        <h4>ä½¿ç”¨åœºæ™¯</h4>
                        <ul style="margin: 0; padding-left: 20px; color: #6b7280;">
                            <li>éšæœºåˆ†é…é‚®ç®±ç»™ä»»åŠ¡</li>
                            <li>æŒ‰æ ‡ç­¾éšæœºæŠ½å–é‚®ç®±è¿›è¡Œæµ‹è¯•</li>
                            <li>é¿å…é‡å¤ä½¿ç”¨åŒä¸€æ‰¹é‚®ç®±</li>
                            <li>å®ç°é‚®ç®±æ± çš„éšæœºè½®æ¢</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- åˆ·æ–°Token -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method post">POST</span>
                        <span class="api-path">/accounts/{email_id}/refresh-token</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('refreshToken')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">æ‰‹åŠ¨åˆ·æ–°æŒ‡å®šè´¦æˆ·çš„è®¿é—®Tokenã€‚</p>

                                    <div class="api-section">
                                        <h4>è·¯å¾„å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">email_id</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ç®±åœ°å€ï¼Œéœ€è¦URLç¼–ç </span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "email_id": "example@outlook.com",
  "status": "success",
  "refresh_time": "2025-01-15 14:30:00",
  "message": "Tokenåˆ·æ–°æˆåŠŸ"
}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ç®¡ç†é¢æ¿API -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div>
                                        <h3 style="margin: 0; color: #1f2937;">âš™ï¸ ç®¡ç†é¢æ¿</h3>
                                    </div>
                                </div>
                            </div>

            <!-- è·å–è¡¨è®°å½•æ•° -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method get">GET</span>
                        <span class="api-path">/admin/tables/{table_name}/count</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('tableCount')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">è·å–æŒ‡å®šæ•°æ®è¡¨çš„è®°å½•æ•°ã€‚</p>

                                    <div class="api-section">
                                        <h4>è·¯å¾„å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">table_name</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">è¡¨å (accounts, admins, system_config)</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "count": 25
}</div>
                                    </div>
                                </div>
                            </div>

            <!-- è·å–è¡¨æ•°æ® -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method get">GET</span>
                        <span class="api-path">/admin/tables/{table_name}</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('tableData')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">è·å–æŒ‡å®šæ•°æ®è¡¨çš„æ‰€æœ‰è®°å½•ã€‚</p>

                                    <div class="api-section">
                                        <h4>è·¯å¾„å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">table_name</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">è¡¨å (accounts, admins, system_config)</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "table_name": "accounts",
  "page": 1,
  "page_size": 1000,
  "total_records": 25,
  "records": [
    {
      "id": 1,
      "email": "example@outlook.com",
      "client_id": "xxx",
      "tags": "[\"å·¥ä½œ\"]",
      "created_at": "2025-01-01 12:00:00"
    }
  ]
}</div>
                                    </div>
                                </div>
                            </div>

            <!-- åˆ é™¤è¡¨è®°å½• -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method delete">DELETE</span>
                        <span class="api-path">/admin/tables/{table_name}/{record_id}</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('deleteTableRecord')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">åˆ é™¤æŒ‡å®šè¡¨ä¸­çš„è®°å½•ã€‚</p>

                                    <div class="api-section">
                                        <h4>è·¯å¾„å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">table_name</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">è¡¨å</span>
                                            </div>
                                            <div class="api-param">
                                                <span class="api-param-name">record_id</span>
                                                <span class="api-param-type">integer</span>
                                                <span class="api-param-desc">è®°å½•ID</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "message": "è®°å½• 1 åˆ é™¤æˆåŠŸ"
}</div>
                                    </div>
                                </div>
                            </div>

            <!-- è·å–ç³»ç»Ÿé…ç½® -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method get">GET</span>
                        <span class="api-path">/admin/config</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('getConfig')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">è·å–æ‰€æœ‰ç³»ç»Ÿé…ç½®é¡¹ã€‚</p>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "configs": [
    {
      "id": 1,
      "key": "imap_server",
      "value": "outlook.office365.com",
      "description": "IMAPæœåŠ¡å™¨åœ°å€",
      "updated_at": "2025-01-01 12:00:00"
    }
  ]
}</div>
                                    </div>
                                </div>
                            </div>

            <!-- æ›´æ–°ç³»ç»Ÿé…ç½® -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method post">POST</span>
                        <span class="api-path">/admin/config</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('updateConfig')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">åˆ›å»ºæˆ–æ›´æ–°ç³»ç»Ÿé…ç½®é¡¹ã€‚</p>

                                    <div class="api-section">
                                        <h4>è¯·æ±‚ä½“</h4>
                                        <div class="api-example">{
  "key": "imap_server",
  "value": "outlook.office365.com",
  "description": "IMAPæœåŠ¡å™¨åœ°å€"
}</div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "message": "é…ç½® imap_server æ›´æ–°æˆåŠŸ"
}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ç³»ç»ŸçŠ¶æ€ -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div>
                                        <h3 style="margin: 0; color: #1f2937;">ğŸ“Š ç³»ç»Ÿä¿¡æ¯</h3>
                                    </div>
                                </div>
                            </div>

            <!-- è·å–ç³»ç»ŸçŠ¶æ€ -->
            <div class="api-endpoint">
                <div class="api-header">
                    <div style="display: flex; align-items: center;">
                        <span class="api-method get">GET</span>
                        <span class="api-path">/api</span>
                    </div>
                    <button class="api-try-button" onclick="openApiTest('systemInfo')">ğŸš€ è¯•ç”¨æ¥å£</button>
                </div>
                                <div class="api-body">
                                    <p class="api-description">è·å–ç³»ç»Ÿç‰ˆæœ¬å’ŒçŠ¶æ€ä¿¡æ¯ï¼ˆæ— éœ€è®¤è¯ï¼‰ã€‚</p>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "name": "Outlook Email Management System",
  "version": "2.0.0",
  "status": "running",
  "features": [
    "JWTè®¤è¯ç³»ç»Ÿ",
    "SQLiteæ•°æ®å­˜å‚¨",
    "æ»šåŠ¨æ—¥å¿—è®°å½•",
    "ç®¡ç†é¢æ¿"
  ]
}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ç¼“å­˜ç®¡ç† -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div>
                                        <h3 style="margin: 0; color: #1f2937;">ğŸ—‘ï¸ ç¼“å­˜ç®¡ç†</h3>
                                    </div>
                                </div>
                            </div>

                            <!-- æ¸…é™¤æŒ‡å®šé‚®ç®±ç¼“å­˜ -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div style="display: flex; align-items: center;">
                                        <span class="api-method delete">DELETE</span>
                                        <span class="api-path">/cache/{email_id}</span>
                                    </div>
                                    <button class="api-try-button" onclick="openApiTest('clearCache')">ğŸš€ è¯•ç”¨æ¥å£</button>
                                </div>
                                <div class="api-body">
                                    <p class="api-description">æ¸…é™¤æŒ‡å®šé‚®ç®±çš„é‚®ä»¶åˆ—è¡¨ç¼“å­˜ã€‚</p>

                                    <div class="api-section">
                                        <h4>è·¯å¾„å‚æ•°</h4>
                                        <div class="api-params">
                                            <div class="api-param">
                                                <span class="api-param-name">email_id</span>
                                                <span class="api-param-type">string</span>
                                                <span class="api-param-desc">é‚®ç®±åœ°å€ï¼Œéœ€è¦URLç¼–ç </span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "message": "Cache cleared for example@outlook.com"
}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- æ¸…é™¤æ‰€æœ‰ç¼“å­˜ -->
                            <div class="api-endpoint">
                                <div class="api-header">
                                    <div style="display: flex; align-items: center;">
                                        <span class="api-method delete">DELETE</span>
                                        <span class="api-path">/cache</span>
                                    </div>
                                    <button class="api-try-button" onclick="openApiTest('clearAllCache')">ğŸš€ è¯•ç”¨æ¥å£</button>
                                </div>
                                <div class="api-body">
                                    <p class="api-description">æ¸…é™¤æ‰€æœ‰é‚®ç®±çš„é‚®ä»¶åˆ—è¡¨ç¼“å­˜ã€‚</p>

                                    <div class="api-section">
                                        <h4>å“åº”ç¤ºä¾‹</h4>
                                        <div class="api-example">{
  "message": "All cache cleared"
}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- é‚®ä»¶åˆ—è¡¨é¡µé¢ -->
                <div id="emailsPage" class="page hidden">
                    <div class="card">
                        <!-- è´¦æˆ·ä¿¡æ¯å’Œæ“ä½œæŒ‰é’® -->
                        <div class="email-compact-header">
                            <div class="email-header-left">
                                <span class="email-current-account">
                                    <span id="currentAccountEmail" onclick="copyEmailAddress(this.textContent)" title="ç‚¹å‡»å¤åˆ¶">-</span>
                                </span>
                                <span class="email-stats-compact">
                                    <span id="totalEmailCount">0</span>å° Â· 
                                    <span id="unreadEmailCount">0</span>æœªè¯» Â· 
                                    <span id="todayEmailCount">0</span>ä»Šæ—¥
                                </span>
                            </div>
                            <div class="email-header-right">
                                <button class="btn btn-primary btn-sm" onclick="refreshEmails()" id="refreshBtn" title="åˆ·æ–°é‚®ä»¶åˆ—è¡¨">
                                    <span>ğŸ”„</span>
                                </button>
                                <button class="btn btn-secondary btn-sm" onclick="clearCache()" title="æ¸…é™¤ç¼“å­˜">
                                    <span>ğŸ—‘ï¸</span>
                                </button>
                                <button class="btn btn-secondary btn-sm" onclick="exportEmails()" title="å¯¼å‡ºé‚®ä»¶">
                                    <span>ğŸ“¤</span>
                                </button>
                                <button class="btn btn-secondary btn-sm" onclick="backToAccounts()" title="è¿”å›è´¦æˆ·åˆ—è¡¨">
                                    <span>â†</span>
                                </button>
                            </div>
                        </div>
                        <!-- éšè—çš„ç»Ÿè®¡å…ƒç´ ï¼ˆä¿æŒå…¼å®¹æ€§ï¼‰ -->
                        <div style="display: none;">
                            <span id="attachmentEmailCount">0</span>
                            <span id="lastUpdateTime">-</span>
                        </div>

                        <!-- æœç´¢å’Œè¿‡æ»¤ -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                            <div class="search-container">
                                <span class="search-icon">ğŸ‘¤</span>
                                <input type="text" class="search-input" id="senderSearch" placeholder="æœç´¢å‘ä»¶äºº..." onkeyup="searchAndLoadEmails()">
                            </div>
                            <div class="search-container">
                                <span class="search-icon">ğŸ“§</span>
                                <input type="text" class="search-input" id="subjectSearch" placeholder="æœç´¢ä¸»é¢˜..." onkeyup="searchAndLoadEmails()">
                            </div>
                        </div>

                        <div class="filter-container">
                            <div class="filter-group">
                                <label class="filter-label">æ–‡ä»¶å¤¹:</label>
                                <select class="filter-select" id="folderFilter" onchange="loadEmails()">
                                    <option value="all">å…¨éƒ¨é‚®ä»¶</option>
                                    <option value="inbox">æ”¶ä»¶ç®±</option>
                                    <option value="junk">åƒåœ¾é‚®ä»¶</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">æ’åº:</label>
                                <select class="filter-select" id="sortOrder" onchange="loadEmails()">
                                    <option value="desc">æ—¥æœŸå€’åºï¼ˆæœ€æ–°åœ¨å‰ï¼‰</option>
                                    <option value="asc">æ—¥æœŸæ­£åºï¼ˆæœ€æ—§åœ¨å‰ï¼‰</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">æ¯é¡µæ˜¾ç¤º:</label>
                                <select class="filter-select" id="emailPageSize" onchange="changeEmailPageSize()">
                                    <option value="20">20æ¡</option>
                                    <option value="50">50æ¡</option>
                                    <option value="100" selected>100æ¡</option>
                                </select>
                            </div>
                            <button class="btn btn-primary btn-sm" onclick="loadEmails(true)">
                                <span>ğŸ”</span>
                                æœç´¢
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="clearSearchFilters()">
                                <span>ğŸ—‘ï¸</span>
                                æ¸…é™¤æœç´¢
                            </button>
                        </div>

                        <!-- åˆ†é¡µæ§ä»¶ -->
                        <div class="pagination-controls" style="display: flex; align-items: center; justify-content: center; gap: 16px; margin-bottom: 16px; padding: 12px; background: white; border-radius: 8px;">
                            <button class="btn btn-secondary btn-sm" onclick="emailPrevPage()" id="emailPrevBtn">
                                <span>â—€</span> ä¸Šä¸€é¡µ
                            </button>
                            <span style="font-size: 0.875rem; color: #64748b;">
                                ç¬¬ <strong id="emailCurrentPageDisplay">1</strong> é¡µ 
                                <span id="emailTotalInfo"></span>
                            </span>
                            <button class="btn btn-secondary btn-sm" onclick="emailNextPage()" id="emailNextBtn">
                                ä¸‹ä¸€é¡µ <span>â–¶</span>
                            </button>
                        </div>

                        <!-- é‚®ä»¶åˆ—è¡¨è¡¨æ ¼ -->
                        <div class="emails-table-container">
                            <table class="emails-table">
                                <thead>
                                    <tr>
                                        <th style="width: 35%;">å‘ä»¶äºº</th>
                                        <th style="width: 40%;">ä¸»é¢˜</th>
                                        <th style="width: 15%;">æ—¥æœŸ</th>
                                        <th style="width: 10%;">æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="emailsList">
                                    <tr>
                                        <td colspan="4" style="padding: 40px; text-align: center;">
                                            <div class="loading">
                                                <div class="loading-spinner"></div>
                                                æ­£åœ¨åŠ è½½é‚®ä»¶...
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div id="emailsPagination" class="pagination hidden"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- é€šçŸ¥å®¹å™¨ -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- é‚®ä»¶è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="emailModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="emailModalTitle">é‚®ä»¶è¯¦æƒ…</h3>
                <button class="modal-close" onclick="closeEmailModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="emailModalContent">
                    <div class="loading">æ­£åœ¨åŠ è½½é‚®ä»¶è¯¦æƒ…...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- æ ‡ç­¾ç®¡ç†æ¨¡æ€æ¡† -->
    <div id="tagsModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>ç®¡ç†è´¦æˆ·æ ‡ç­¾</h3>
                <span class="close" onclick="closeTagsModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="currentTags">å½“å‰æ ‡ç­¾</label>
                    <div id="currentTagsList" class="tags-list"></div>
                </div>
                <div class="form-group">
                    <label for="newTag">æ·»åŠ æ–°æ ‡ç­¾</label>
                    <div class="input-group">
                        <input type="text" id="newTag" class="form-control" placeholder="è¾“å…¥æ ‡ç­¾åç§°">
                        <button class="btn btn-primary" onclick="addTag()">æ·»åŠ </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeTagsModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveAccountTags()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- è¡¨è®°å½•ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="recordModal" class="modal hidden">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="recordModalTitle">ç¼–è¾‘è®°å½•</h3>
                <button class="modal-close" onclick="closeRecordModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="recordFormContent"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeRecordModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveTableRecord()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- APIæµ‹è¯•æ¨¡æ€æ¡† -->
    <div id="apiTestModal" class="api-test-modal" onclick="closeApiTestModal(event)">
        <div class="api-test-content" onclick="event.stopPropagation()">
            <div class="api-test-header">
                <h3 id="apiTestTitle">ğŸš€ æµ‹è¯•APIæ¥å£</h3>
                <button class="api-test-close" onclick="closeApiTestModal()">Ã—</button>
            </div>
            <div class="api-test-body">
                <div class="api-test-section">
                    <h4>ğŸ“‹ è¯·æ±‚ä¿¡æ¯</h4>
                    <div class="api-test-info-grid">
                        <div class="api-test-info-item">
                            <label>æ–¹æ³•</label>
                            <span id="apiTestMethod" class="api-method-badge">GET</span>
                        </div>
                        <div class="api-test-info-item">
                            <label>ç«¯ç‚¹</label>
                            <span id="apiTestEndpoint" class="api-endpoint-path">/api</span>
                        </div>
                    </div>
                </div>

                <!-- è·¯å¾„å‚æ•° -->
                <div id="apiTestPathParams" class="api-test-section hidden">
                    <h4>ğŸ”— è·¯å¾„å‚æ•°</h4>
                    <div id="apiTestPathParamsList"></div>
                </div>

                <!-- æŸ¥è¯¢å‚æ•° -->
                <div id="apiTestQueryParams" class="api-test-section hidden">
                    <h4>ğŸ” æŸ¥è¯¢å‚æ•°</h4>
                    <div id="apiTestQueryParamsList"></div>
                </div>

                <!-- è¯·æ±‚ä½“ -->
                <div id="apiTestBody" class="api-test-section hidden">
                    <h4>ğŸ“ è¯·æ±‚ä½“ (JSON)</h4>
                    <div class="api-test-param">
                        <textarea id="apiTestBodyContent" placeholder='{"key": "value"}'></textarea>
                    </div>
                </div>

                <!-- å“åº”ç»“æœ -->
                <div id="apiTestResultSection" class="hidden">
                    <div id="apiTestResult" class="api-test-result">
                        <h4>å“åº”ç»“æœ</h4>
                        <pre id="apiTestResultContent"></pre>
                    </div>
                </div>

                <!-- æ“ä½œæŒ‰é’® -->
                <div class="api-test-actions">
                    <button class="btn btn-primary" onclick="executeApiTest()">
                        <span>â–¶ï¸</span> å‘é€è¯·æ±‚
                    </button>
                    <button class="btn btn-secondary" onclick="resetApiTestForm()">
                        <span>ğŸ”„</span> é‡ç½®
                    </button>
                    <button class="btn btn-secondary" onclick="closeApiTestModal()">
                        <span>âœ–ï¸</span> å…³é—­
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- å³é”®èœå• -->
    <div id="contextMenu" class="context-menu">
        <div class="context-menu-item" onclick="openInNewTab()">
            <span>ğŸ”—</span>
            åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€
        </div>
        <div class="context-menu-item" onclick="copyAccountLink()">
            <span>ğŸ“‹</span>
            å¤åˆ¶é“¾æ¥
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" onclick="contextEditTags()">
            <span>ğŸ·ï¸</span>
            ç®¡ç†æ ‡ç­¾
        </div>
        <div class="context-menu-item danger" onclick="contextDeleteAccount()">
            <span>ğŸ—‘ï¸</span>
            åˆ é™¤è´¦æˆ·
        </div>
    </div>

    <!-- JavaScript æ¨¡å— -->
    <script src="/static/js/api.js"></script>
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/ui.js"></script>
    <script src="/static/js/accounts.js"></script>
    <script src="/static/js/emails.js"></script>
    <script src="/static/js/batch.js"></script>
    <script src="/static/js/tags.js"></script>
    <script src="/static/js/apidocs.js"></script>
    <script src="/static/js/admin.js"></script>
    <script src="/static/js/apitest.js"></script>
    <script src="/static/js/context-menu.js"></script>
    <script src="/static/js/main.js"></script>
</body>
</html>